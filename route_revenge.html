<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>åŸ‹ã¾ã‚‰ãªã„äºˆå®Ÿå·®ã®é—‡ - Chapter 1: Revenge</title>
<style>
    /* â–¼â–¼â–¼ å¾©è®ã®èµ¤ã¨é—‡ã®ãƒ‡ã‚¶ã‚¤ãƒ³ â–¼â–¼â–¼ */
    :root {
        --bg-color: #050000;
        --text-main: #d0d0d0;
        --accent-red: #8a0000;
        --accent-blood: #ff0000;
        --accent-ghost: #ff4444;
    }

    body {
        background-color: var(--bg-color);
        color: var(--text-main);
        font-family: "Yu Mincho", "Hiragino Mincho ProN", serif;
        line-height: 2.4;
        letter-spacing: 0.05em;
        margin: 0;
        display: flex;
        justify-content: center;
        min-height: 100vh;
        overflow: hidden; /* èƒŒæ™¯ç”»åƒç”¨ */
    }

    /* === ãƒ¬ã‚¤ãƒ¤ãƒ¼æ§‹é€  === */
    #layer-group {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        z-index: -1; pointer-events: none;
    }
    #bg-layer {
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        background-size: cover; background-position: center;
        transition: opacity 1s ease; 
        opacity: 0.5;
        filter: contrast(1.3) brightness(0.7); /* æš—ãã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆå¼·ã */
    }
    #cg-layer {
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        display: flex; justify-content: center; align-items: center;
    }
    #cg-image {
        max-height: 90%; max-width: 90%;
        opacity: 0; transition: opacity 1s ease;
        filter: drop-shadow(0 0 20px #800); /* èµ¤ã„å½± */
    }

    #game-wrapper {
        width: 100%;
        max-width: 840px;
        height: 95vh;
        background-color: rgba(15, 2, 2, 0.9);
        box-shadow: 0 0 100px rgba(138, 0, 0, 0.2);
        display: flex;
        flex-direction: column;
        border: 2px solid #300;
        position: relative;
        overflow-y: auto;
    }

    /* ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ãƒ˜ãƒƒãƒ€ãƒ¼ */
    #scene-header {
        height: 200px;
        background-size: cover;
        background-position: center;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        overflow: hidden;
        border-bottom: 1px solid #300;
        flex-shrink: 0;
        transition: background-image 0.5s ease;
    }
    #scene-header::before {
        content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
        background: linear-gradient(180deg, rgba(20,0,0,0.6) 0%, rgba(0,0,0,0.85) 100%);
        z-index: 1;
    }
    /* æŠ½è±¡çš„ã‚·ãƒ³ãƒœãƒ«ï¼ˆåˆƒï¼‰ */
    #scene-symbol {
        width: 2px; height: 50px;
        background: linear-gradient(180deg, transparent 0%, rgba(208,2,27,0.4) 50%, transparent 100%);
        position: relative;
        opacity: 0.6;
        z-index: 2;
    }
    #scene-symbol::before {
        content: ''; position: absolute;
        top: 25%; left: 50%; transform: translate(-50%, 0) rotate(45deg);
        width: 16px; height: 16px;
        border-top: 1px solid rgba(208,2,27,0.3);
        border-right: 1px solid rgba(208,2,27,0.3);
    }
    
    .blood-overlay {
        position: absolute; top:0; left:0; width:100%; height:100%;
        background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%"><circle cx="50%" cy="50%" r="40%" fill="rgba(255,0,0,0.1)" filter="url(%23blur)"/></svg>');
        opacity: 0; transition: opacity 2s; pointer-events: none;
        mix-blend-mode: multiply;
    }
    .blood-overlay.active { opacity: 1; background-color: rgba(50,0,0,0.3); }

    /* æœ¬æ–‡ã‚¨ãƒªã‚¢ */
    #narrative-area {
        padding: 40px 50px;
        flex-grow: 1;
        font-size: 1.1rem;
        text-align: justify;
    }
    
    p { margin-bottom: 2.5em; opacity: 0; animation: fadeIn 1s forwards; }
    @keyframes fadeIn { to { opacity: 1; } }

    .highlight { color: var(--accent-blood); font-weight: bold; }
    .name { color: #b55; font-weight: bold; font-family: sans-serif; font-size: 0.9em; display: block; margin-bottom: 1em; }
    
    .ghost-voice { 
        color: var(--accent-ghost); font-family: monospace; 
        text-shadow: 2px 0 5px rgba(255,0,0,0.5);
        border-left: 3px solid var(--accent-red); padding-left: 20px; margin: 2em 0;
        letter-spacing: 0.1em;
    }
    
    .glitch { animation: glitch 0.2s infinite; display: inline-block; font-weight: bold; color: #f00; }
    @keyframes glitch { 0% {transform: translate(0)} 20% {transform: translate(-2px, 2px)} 40% {transform: translate(2px, -2px)} 100% {transform: translate(0)} }

    /* ã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã‚«ãƒ¼ãƒ‰ */
    .ending-card {
        margin-top: 50px; padding: 40px; border: 1px solid #666; text-align: center;
        color: #888; opacity: 0; animation: fadeIn 3s forwards; animation-delay: 1s;
        background: rgba(0,0,0,0.8);
    }
    .end-title { font-size: 2rem; margin-bottom: 20px; letter-spacing: 0.2em; font-weight: bold; color: #666; }

    /* é¸æŠè‚¢ã‚¨ãƒªã‚¢ */
    #choices-container {
        padding: 40px 60px 80px;
        display: flex;
        flex-direction: column;
        gap: 20px;
        background: linear-gradient(to top, rgba(0,0,0,0.9) 0%, rgba(15,2,2,0.9) 100%);
        border-top: 1px solid #300;
    }
    button {
        background: rgba(26,5,5,0.9); color: #a88; border: 1px solid #522;
        padding: 25px 30px; text-align: left; 
        font-family: "Yu Mincho", serif; font-size: 1.05rem;
        cursor: pointer; transition: all 0.3s; position: relative;
    }
    button:hover { background: #300; color: #fff; border-color: #f00; padding-left: 40px; box-shadow: 0 0 15px rgba(255,0,0,0.2); }
    button::before { content: "ğŸ”ª"; position: absolute; left: 15px; opacity: 0; transition: opacity 0.3s; color: #f00; font-size: 0.8em; }
    button:hover::before { opacity: 1; }

    /* æ‹’çµ¶ãƒœã‚¿ãƒ³ */
    .btn-refuse { border-color: #666; color: #888; }
    .btn-refuse:hover { background: #222; border-color: #fff; box-shadow: none; }
    .btn-refuse::before { content: "âœ‹"; color: #fff; }

</style>
</head>
<body>

<div id="layer-group">
    <div id="bg-layer"></div>
    <div id="cg-layer"><img id="cg-image" src="" alt=""></div>
</div>

<div id="game-wrapper">
    <div id="scene-header">
        <div id="scene-symbol"></div>
        <div id="blood-fx" class="blood-overlay"></div>
    </div>

    <div id="narrative-area"></div>
    <div id="choices-container"></div>
</div>

<script src="audio.js"></script>
<script>
    /* =========================================
       ã‚·ã‚¹ãƒ†ãƒ åˆ¶å¾¡ (Audio & Image)
       ========================================= */
    // AudioEngineã‚’ãƒ©ãƒƒãƒ—ã—ã¦å¾“æ¥ã®audioã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æä¾›
    const audio = {
        currentBgm: "",
        
        playBgm: function(filename) {
            if(this.currentBgm === filename) return;
            // ã‚·ãƒ³ã‚»BGM
            if(filename === "bgm_mystery") AudioEngine.playMysteryTheme();
            else if(filename === "bgm_horror") AudioEngine.playHorrorTheme();
            else if(filename === "bgm_chase") AudioEngine.playChaseTheme();
            // ç’°å¢ƒéŸ³
            else if(filename === "bgm_office") AudioEngine.playAmbience("office");
            else if(filename === "bgm_rain") AudioEngine.playAmbience("rain");
            else if(filename === "bgm_abyss") AudioEngine.playAmbience("abyss");
            // MP3
            else if(filename === "opening" || filename === "bgm_title") AudioEngine.playTitleTheme();
            else if(filename === "flashback") AudioEngine.playFlashbackTheme();
            else if(filename === "confession") AudioEngine.playConfessionTheme();
            else if(filename === "ending" || filename === "bgm_ending") AudioEngine.playEndingTheme();
            else AudioEngine.playMp3("audio/" + filename + ".mp3");
            this.currentBgm = filename;
        },
        stopBgm: function() {
            AudioEngine.stopMusic();
            this.currentBgm = "";
        },
        playSe: function(filename) {
            // ã‚·ãƒ³ã‚»SEã‚’ä½¿ç”¨
            if(filename === "se_ping" || filename === "ping") AudioEngine.playPing();
            else if(filename === "se_glitch" || filename === "glitch") AudioEngine.playGlitch();
            else if(filename === "se_heart" || filename === "heart") AudioEngine.playHeartbeat();
            else if(filename === "se_slam" || filename === "slam") AudioEngine.playSlam();
            else if(filename === "se_shredder" || filename === "shredder") AudioEngine.playShredder();
            else if(filename === "se_execution" || filename === "execution") AudioEngine.playExecution();
            else if(filename === "se_stamp" || filename === "stamp") AudioEngine.playStamp();
            else if(filename === "se_impact" || filename === "impact") AudioEngine.playImpact();
        }
    };

    const visuals = {
        bg: document.getElementById("bg-layer"),
        cg: document.getElementById("cg-image"),
        
        setBg: function(filename) {
            if(!filename) return;
            this.bg.style.backgroundImage = `url('images/${filename}.jpg')`;
        },
        setCg: function(filename) {
            if(!filename) {
                this.cg.style.opacity = 0;
            } else {
                this.cg.src = `images/${filename}.png`;
                this.cg.style.opacity = 1;
            }
        },
        setFilter: function(type) {
            if(type === "blood") {
                this.bg.style.filter = "sepia(0.5) hue-rotate(-50deg) saturate(3) contrast(1.5)"; // çœŸã£èµ¤
            } else {
                this.bg.style.filter = "contrast(1.3) brightness(0.7)"; // é€šå¸¸ï¼ˆæš—ã„ï¼‰
            }
        }
    };

    // â–¼â–¼â–¼ ã‚·ãƒŠãƒªã‚ªãƒ‡ãƒ¼ã‚¿ï¼ˆå¾©è®ç·¨ï¼šç”»åƒãƒ»éŸ³å£°çµ±åˆç‰ˆï¼‰ â–¼â–¼â–¼
    const scenes = {
        // --- å°å…¥ï¼šå…±çŠ¯å¥‘ç´„ ---
        start: {
            icon: "ğŸ’¢",
            bg: "bg_office_night",    // â˜…èƒŒæ™¯ï¼šã‚ªãƒ•ã‚£ã‚¹
            sound: "se_slam",         // â˜…SEï¼šæ‰“æ’ƒ
            music: "bgm_mystery",     // â˜…BGMï¼šä¸ç©
            text: `
                <span class="name">æ·±å¤œ2:20 è²¡å‹™çµŒç†éƒ¨ãƒ•ãƒ­ã‚¢</span>
                <p>ã€Œãµã–ã‘ã‚‹ãªï¼ï¼ã€</p>
                <p>ç§ã¯ç”»é¢ã«å‘ã‹ã£ã¦æ€’é³´ã‚Šã¤ã‘ãŸã€‚<br>
                ãã®å£°ã¯ã€ææ€–ã‹ã‚‰ã§ã¯ãªãã€åº•ãªã—ã®æ†æ‚ªã‹ã‚‰å‡ºãŸã‚‚ã®ã ã£ãŸã€‚</p>
                <p>ã€Œç¾å’²ã‚’æ®ºã—ãŸã®ã¯ä¼šç¤¾ã ï¼ æ¨©ç”°éƒ¨é•·ã ï¼ çŠ¬é£¼ã ï¼ ä¿ºã˜ã‚ƒãªã„ï¼ã€<br>
                ã€Œãªã‚“ã§ä¿ºã®ã¨ã“ã‚ã«æ¥ã‚‹ã‚“ã ã‚ˆï¼ æ–‡å¥ãŒã‚ã‚‹ãªã‚‰ã‚ã„ã¤ã‚‰ã®ã¨ã“ã‚ã¸è¡Œã‘ã‚ˆï¼ã€</p>
                <p>ç½ªæ‚ªæ„Ÿã®è£è¿”ã—ã€‚è‡ªå·±é˜²è¡›ã®ãŸã‚ã®é†œã„é€†ã‚®ãƒ¬ã€‚<br>
                ç§ã®çµ¶å«ãŒæ·±å¤œã®ã‚ªãƒ•ã‚£ã‚¹ã«å¸ã„è¾¼ã¾ã‚ŒãŸç¬é–“ã€ç”»é¢ã®å‘ã“ã†ã®æ°—é…ãŒå¤‰ã‚ã£ãŸã€‚<br>
                æ¸©åº¦ãŒæ€¥æ¿€ã«ä¸‹ãŒã‚‹ã€‚ãƒ¢ãƒ‹ã‚¿ãƒ¼ãŒèµ¤é»’ãæ˜æ»…ã‚’å§‹ã‚ã‚‹ã€‚</p>
                <p class="ghost-voice">
                ã€â€¦â€¦ã‚½ã‚¦ãƒ€ãƒã€‚äºœä¹…æ–—ã‚¯ãƒ³ãƒæ‚ªã‚¯ãƒŠã‚¤ã€‚ã€<br>
                ã€æ‚ªã‚¤ãƒãƒã€ã‚¢ã‚¤ãƒ„ãƒ©ãƒ€ã€‚ã€
                </p>
                <p>ç¾å’²ã®å£°ãŒã€é¼“è†œã§ã¯ãªãè„³é«„ã«ç›´æ¥éŸ¿ã„ã¦ãã‚‹ã€‚<br>
                å½¼å¥³ã¯æ€’ã£ã¦ã„ã‚‹ã®ã§ã¯ãªã„ã€‚ç¬‘ã£ã¦ã„ã‚‹ã®ã ã€‚<br>
                æ„›ã™ã‚‹ç”·ãŒã€è‡ªåˆ†ã¨åŒã˜ã€Œæ†ã—ã¿ã€ã®è‰²ã«æŸ“ã¾ã£ãŸã“ã¨ã‚’å–œã‚“ã§ã„ã‚‹ã®ã ã€‚</p>
                <p class="ghost-voice">
                ã€ã‚¸ãƒ£ã‚¢ã€æ‰‹ä¼ãƒƒãƒ†ã‚¯ãƒ¬ãƒ«ï¼Ÿ ç›£æŸ»ï¼ˆå¾©è®ï¼‰ãƒ²ã€‚ã€
                </p>
            `,
            choices: [
                { text: "ã€Œã‚ã‚ã€ã‚„ã£ã¦ã‚„ã‚‹ã€ã¨ç­”ãˆã‚‹", next: "download_data" }
            ]
        },

        // --- ãƒ‡ãƒ¼ã‚¿å…¥æ‰‹ ---
        download_data: {
            icon: "ğŸ’¾",
            bg: "bg_office_night",
            cg: "cg_misaki_ghost_hollow", // â˜…CGï¼šé‚ªæ‚ªã«å¾®ç¬‘ã‚€ç¾å’²
            effect: { flag: "got_data" },
            text: `
                <p>ç”»é¢ã«ã€Excelãƒ•ã‚¡ã‚¤ãƒ«ãŒæ·»ä»˜ã•ã‚Œã‚‹ã€‚<br>
                ãƒ•ã‚¡ã‚¤ãƒ«åï¼šã€è£å¸³ç°¿_Confidential.xlsxã€ã€‚</p>
                <p>ç§ã¯éœ‡ãˆã‚‹æ‰‹ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸã€‚<br>
                ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ã¯ã€å‡„æƒ¨ãªã‚‚ã®ã ã£ãŸã€‚<br>
                æ¨©ç”°éƒ¨é•·ã«ã‚ˆã‚‹äº¤éš›è²»ã®ç§çš„æµç”¨ã€æ¶ç©ºå–å¼•ã®è¨˜éŒ²ã€‚<br>
                çŠ¬é£¼å…ˆè¼©ãŒç¾å’²ã®PCã«ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹ã—ã€ãƒ‡ãƒ¼ã‚¿ã‚’æ”¹ã–ã‚“ã—ã¦ã„ãŸãƒ­ã‚°ã€‚<br>
                ãã—ã¦ã€éš ã—ãƒ•ã‚©ãƒ«ãƒ€ã«ã¯éŸ³å£°ãƒ‡ãƒ¼ã‚¿ãŒå…¥ã£ã¦ã„ãŸã€‚</p>
                <p>å†ç”Ÿãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã€‚<br>
                ã€ãŠå‰ã®ä»£ã‚ã‚Šãªã‚“ã¦ã„ãã‚‰ã§ã‚‚ã„ã‚‹ã‚“ã ã‚ˆï¼ æ­»ã‚“ã§è©«ã³ã‚ï¼ã€<br>
                æ¨©ç”°ã®ç½µå£°ã€‚ç¾å’²ã®å—šå’½ã€‚<br>
                ã€è‡ªæ®ºã¨ã‹ãƒã‚¸å‹˜å¼ï½—ã€<br>
                çŠ¬é£¼ã®å˜²ç¬‘ã€‚</p>
                <p>ç§ã®ä½“ä¸­ã‚’ã€ãƒã‚°ãƒã®ã‚ˆã†ãªæ®ºæ„ãŒé§†ã‘å·¡ã‚‹ã€‚<br>
                è¦–ç•ŒãŒèµ¤ãæŸ“ã¾ã‚‹ã€‚</p>
                <p>ã€Œæ®ºã™â€¦â€¦ã€<br>
                è‡ªç„¶ã¨å£ã‚’ã¤ã„ã¦å‡ºãŸã€‚<br>
                ã€Œç‰©ç†çš„ã«ã€ç¤¾ä¼šçš„ã«ã€æŠ¹æ®ºã—ã¦ã‚„ã‚‹ã€</p>
                <p class="ghost-voice">
                ã€ã‚¦ãƒ¬ã‚·ã‚¤ã€‚äºœä¹…æ–—ã‚¯ãƒ³ã€å¤§å¥½ã‚­ã€‚ã€<br>
                ã€æ˜æ—¥ã€å®Ÿå®¶ãƒ‹æ¥ãƒ†ã€‚æœ€å¾Œãƒã€Œæ­¦å™¨ã€ãƒ²æ¸¡ã‚¹ã‹ã‚‰ã€‚ã€
                </p>
            `,
            choices: [
                { text: "ç¿Œæ—¥ã€ç¾å’²ã®å®Ÿå®¶ã¸å‘ã‹ã†", next: "visit_home" }
            ]
        },

        // --- å®Ÿå®¶è¨ªå• ---
        visit_home: {
            icon: "ğŸ ",
            bg: "bg_home_altar", // â˜…èƒŒæ™¯ï¼šå®Ÿå®¶
            cg: "",
            music: "bgm_rain",   // â˜…Ambienceï¼šé›¨
            text: `
                <span class="name">ç¿Œæ—¥ æ—¥æ›œæ—¥ ç¾å’²ã®å®Ÿå®¶</span>
                <p>ç§ã¯å°ã‹ã‚Œã‚‹ã‚ˆã†ã«ç¾å’²ã®å®Ÿå®¶ã‚’è¨ªã‚Œã¦ã„ãŸã€‚<br>
                ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ›ãƒ³ã‚’æŠ¼ã™ã¨ã€ã‚„ã¤ã‚ŒãŸæ¯è¦ªãŒå‡ºã¦ããŸã€‚<br>
                ä»¥å‰ä¼šã£ãŸæ™‚ã®ç©ã‚„ã‹ãªé¢å½±ã¯ãªã„ã€‚é ¬ãŒã“ã‘ã€ç›®ãŒè½ã¡çªªã¿ã€ç‹‚æ°—ã¨æ­£æ°—ã®å¢ƒç•Œã‚’å½·å¾¨ã£ã¦ã„ã‚‹ã‚ˆã†ã ã£ãŸã€‚</p>
                <p>ã€Œâ€¦â€¦ã‚ˆãæ¥ãŸã‚ã­ã€è£åˆ‡ã‚Šè€…ã€</p>
                <p>é€šã•ã‚ŒãŸéƒ¨å±‹ã¯è–„æš—ãã€ç·šé¦™ã®åŒ‚ã„ãŒå……æº€ã—ã¦ã„ãŸã€‚<br>
                ä»å£‡ã®éºå½±ã ã‘ãŒã€æ¥½ã—ã‹ã£ãŸé ƒã®ç¬‘é¡”ã§ç§ã‚’è¦‹ã¤ã‚ã¦ã„ã‚‹ã€‚<br>
                æ¯è¦ªãŒã€ç”»é¢ã®å‰²ã‚ŒãŸã‚¹ãƒãƒ›ã‚’ç§ã«çªãã¤ã‘ã¦ãã‚‹ã€‚ç¾å’²ã®éºå“ã ã€‚</p>
                <p>ã€Œã“ã‚Œã‚’è¦‹ãªã•ã„ï¼ ã‚ã‚“ãŸã¸ã®æœªç·´ã¨ã€ã‚ã„ã¤ã‚‰ã¸ã®å‘ªã„ãŒæ›¸ã„ã¦ã‚ã‚‹ã‚ï¼ã€<br>
                ã€Œã‚ã®å­ã¯æ‚”ã—ã‹ã£ãŸã®ã‚ˆï¼ ãªã‚“ã§ã‚ã®å­ãŒæ­»ã‚“ã§ã€äººæ®ºã—ãŸã¡ãŒã®ã†ã®ã†ã¨ç”Ÿãã¦ã‚‹ã®ï¼ï¼Ÿã€</p>
                <p>æ¯è¦ªã¯å«ã³ãªãŒã‚‰ã€ç§ã®èƒ¸ãã‚‰ã‚’æ´ã‚“ã ã€‚<br>
                ã€Œè²¬ä»»å–ã‚Šãªã•ã„ã‚ˆï¼ï¼ ã‚ã„ã¤ã‚‰ã«å¾©è®ã—ã¦ã‚ˆï¼ï¼ã€</p>
            `,
            choices: [
                { text: "ã€Œåƒ•ãŒã‚„ã‚Šã¾ã™ã€‚ãã®ãŸã‚ã«æ¥ã¾ã—ãŸã€", next: "pact_mom" },
                { text: "ã€Œâ€¦â€¦åƒ•ã«ã¯é–¢ä¿‚ã‚ã‚Šã¾ã›ã‚“ã€ã¨è¨€ã„é€ƒã‚Œã‚‹", next: "evade_1", class: "btn-refuse" }
            ]
        },

        // -----------------------------------------------------------
        // ãƒãƒƒãƒ‰ã‚¨ãƒ³ãƒ‰åˆ†å²ï¼šè²¬ä»»è»¢å«ã®æ³¥æ²¼
        // -----------------------------------------------------------
        evade_1: {
            icon: "ğŸ˜¶",
            bg: "bg_home_altar",
            music: "bgm_horror", // â˜…BGMï¼šä¸ç©
            text: `
                <p>ã€Œâ€¦â€¦ã¡ã‚‡ã£ã¨å¾…ã£ã¦ãã ã•ã„ã€‚åƒ•ã«ã¯é–¢ä¿‚ã‚ã‚Šã¾ã›ã‚“ã€</p>
                <p>ç§ã¯æ¯è¦ªã®æ‰‹ã‚’æŒ¯ã‚Šæ‰•ã†ã‚ˆã†ã«ã—ã¦å¾Œãšã•ã£ãŸã€‚<br>
                ã€ŒãŸã—ã‹ã«åƒ•ã¯é›»è©±ã«å‡ºã‚‰ã‚Œãªã‹ã£ãŸã€‚ã§ã‚‚ã€ãŸã ãã‚Œã ã‘ã§ã™ã€‚<br>
                æ®ºã—ãŸã®ã¯éƒ¨é•·ãŸã¡ã§ã—ã‚‡ã†ï¼Ÿ ãªã‚“ã§åƒ•ãŒãƒªã‚¹ã‚¯ã‚’è² ã£ã¦å¾©è®ãªã‚“ã¦ã—ãªãã‚ƒã„ã‘ãªã„ã‚“ã§ã™ã‹ã€</p>
                <p>å£ã‹ã‚‰å‡ºã‚‹ã®ã¯ã€è‡ªåˆ†ã§ã‚‚é©šãã»ã©å†·é…·ãªä¿èº«ã®è¨€è‘‰ã ã£ãŸã€‚<br>
                ã€Œåƒ•ã¯åƒ•ã®äººç”Ÿã‚’å®ˆã‚ŠãŸã„ã‚“ã§ã™ã€‚å·»ãè¾¼ã¾ãªã„ã§ãã ã•ã„ã€</p>
                <p>æ¯è¦ªã®å‹•ããŒæ­¢ã¾ã‚‹ã€‚<br>
                æ€’å·ãŒæ­¢ã¿ã€éƒ¨å±‹ã«ä¸æ°—å‘³ãªé™å¯‚ãŒè½ã¡ãŸã€‚</p>
            `,
            choices: [
                { text: "ç«‹ã¡å»ã‚ã†ã¨ã™ã‚‹", next: "evade_2", class: "btn-refuse" }
            ]
        },

        evade_2: {
            icon: "ğŸ‘¹",
            bg: "bg_home_altar",
            text: `
                <p>ã€Œâ€¦â€¦é–¢ä¿‚ãªã„ï¼Ÿã€</p>
                <p>æ¯è¦ªãŒã€ä½ãã—ã‚ƒãŒã‚ŒãŸå£°ã§å‘Ÿãã€‚<br>
                ã€Œã‚ã®å­ãŒã©ã‚Œã ã‘ã‚ã‚“ãŸã‚’é ¼ã‚Šã«ã—ã¦ã„ãŸã‹ã€‚<br>
                æ¯æ—¥æ¯æ—¥ã€ã‚ã‚“ãŸã®è©±ã‚’ã—ã¦ã„ãŸã‹ã€‚ãã‚Œã‚’â€¦â€¦é–¢ä¿‚ãªã„ï¼Ÿã€</p>
                <p>ã€Œã²ã£â€¦â€¦ã€</p>
                <p>æ¯è¦ªãŒé¡”ã‚’ä¸Šã’ãŸã€‚<br>
                ãã®ç›®ã¯ç™½ç›®ãŒè¡€èµ°ã‚Šã€äººé–“ã®ç†æ€§ã‚’å®Œå…¨ã«å¤±ã£ã¦ã„ãŸã€‚<br>
                å½¼å¥³ã¯ä»å£‡ã®è‹ç‡­ç«‹ã¦ã‚’æ´ã‚€ã¨ã€ç£ã®ã‚ˆã†ãªå’†å“®ã‚’ä¸Šã’ã¦ç§ã«é£›ã³ã‹ã‹ã£ã¦ããŸã€‚</p>
                <p>ã€Œã ã£ãŸã‚‰ã‚ã‚“ãŸãŒæ­»ã­ã‡ã‡ã‡ï¼ï¼ï¼ã€</p>
                <p>ã€Œã†ã‚ã‚ã£ï¼ï¼Ÿã€<br>
                ç§ã¯çªãé£›ã°ã•ã‚Œã€ç•³ã®ä¸Šã«è»¢ãŒã‚‹ã€‚<br>
                æ¯è¦ªãŒé¦¬ä¹—ã‚Šã«ãªã‚Šã€ç´°ã„æŒ‡ã§ç§ã®é¦–ã‚’ç· ã‚ä¸Šã’ã¦ãã‚‹ã€‚<br>
                ã€Œã‚ã®å­ã®ã¨ã“ã‚ã¸è¡Œã‘ï¼ è¬ã£ã¦ã“ã„ï¼ ä»Šã™ãï¼ï¼ã€</p>
            `,
            choices: [
                { text: "å¿…æ­»ã§æŠµæŠ—ã—ã¦é€ƒã’ã‚‹", next: "evade_3", class: "btn-refuse" }
            ]
        },

        evade_3: {
            icon: "ğŸƒ",
            bg: "bg_home_altar",
            sound: "se_impact", // â˜…SEï¼šæ®´æ‰“
            text: `
                <p>ã€Œé›¢ã›ï¼ ã“ã®ç‹‚äººã‚ï¼ï¼ã€</p>
                <p>ç§ã¯ç„¡æˆ‘å¤¢ä¸­ã§æ¯è¦ªã‚’æ®´ã‚Šã¤ã‘ãŸã€‚<br>
                éˆã„éŸ³ãŒã—ã¦ã€æ¯è¦ªãŒæ¨ªã«å€’ã‚Œã‚‹ã€‚<br>
                ç§ã¯æ¯ã‚’åˆ‡ã‚‰ã—ãªãŒã‚‰ç«‹ã¡ä¸ŠãŒã‚Šã€ç„é–¢ã¸ã¨èµ°ã£ãŸã€‚</p>
                <p>å¾Œã‚ã‹ã‚‰ã€å‘ªè©›ã®ã‚ˆã†ãªå£°ãŒè¿½ã„ã‹ã‘ã¦ãã‚‹ã€‚<br>
                ã€Œé€ƒãŒã•ãªã„â€¦â€¦çµ¶å¯¾ã«é€ƒãŒã•ãªã„â€¦â€¦å‘ªã£ã¦ã‚„ã‚‹â€¦â€¦ï¼ã€</p>
                <p>é´ã‚‚å±¥ã‹ãšã«å¤–ã¸é£›ã³å‡ºã™ã€‚<br>
                å¤•æš®ã‚Œã®ä½å®…è¡—ã€‚ã‚«ãƒ©ã‚¹ãŒé³´ã„ã¦ã„ã‚‹ã€‚<br>
                åŠ©ã‹ã£ãŸã€‚ãã†æ€ã£ãŸç¬é–“ã€ãƒã‚±ãƒƒãƒˆã®ä¸­ã§ã‚¹ãƒãƒ›ãŒéœ‡ãˆãŸã€‚</p>
                <p class="ghost-voice">
                ã€æœ€ä½ã€‚ã€
                </p>
            `,
            choices: [
                { text: "â€¦â€¦ãˆï¼Ÿ", next: "bad_end_payment" }
            ]
        },

        // --- BAD END: å¥‘ç´„ä¸å±¥è¡Œ ---
        bad_end_payment: {
            icon: "ğŸ’€",
            bg: "bg_office_night", // ï¼ˆâ€»è·¯ä¸Šã ãŒæš—ã„èƒŒæ™¯ã§ä»£ç”¨ï¼‰
            sound: "se_impact", // â˜…SEï¼šè¡çª
            music: "bgm_ending",
            effect: { blood: false },
            text: `
                <p>ã‚¹ãƒãƒ›ã®ç”»é¢ã‚’è¦‹ã‚‹ã€‚<br>
                Unknown Userã‹ã‚‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€‚</p>
                <p class="ghost-voice">
                ã€ãƒãƒãƒ²æ®´ãƒƒã‚¿ãƒï¼Ÿ<br>
                ç§ãƒã‚³ãƒˆãƒ¢ã€ãƒãƒãƒã‚³ãƒˆãƒ¢ã€è¦‹æ¨ãƒ†ãƒ«ãƒ³ãƒ€ã€‚ã€
                </p>
                <p>ã€Œã¡ã€é•ã†ã€ä¿ºã¯â€¦â€¦ã€</p>
                <p class="ghost-voice">
                ã€æ‰¿èªå´ä¸‹ï¼ˆRejectedï¼‰ã€‚<br>
                å…¨é¡ã€å³æ™‚å„Ÿé‚„ã‚·ãƒ†ä¸‹ã‚µã‚¤ã€‚ã€
                </p>
                <p>ã‚­ã‚­ãƒ¼ãƒƒï¼ï¼</p>
                <p>çªç„¶ã€ç›®ã®å‰ã®äº¤å·®ç‚¹ã«ãƒˆãƒ©ãƒƒã‚¯ãŒçªã£è¾¼ã‚“ã§ããŸã€‚<br>
                é‹è»¢æ‰‹ã¯ãƒãƒ³ãƒ‰ãƒ«ã«çªã£ä¼ã—ã¦ã„ã‚‹ã€‚æ„è­˜ãŒãªã„ï¼Ÿ<br>
                ã„ã‚„ã€é‹è»¢æ‰‹ã®é¡”ãŒâ€•â€•<span class="highlight">ç¾å’²ã®ç¬‘é¡”</span>ã«è¦‹ãˆãŸã€‚</p>
                <p>ã€Œã‚â€¦â€¦ã€</p>
                <p>è¡æ’ƒã€‚ãã—ã¦ã€è‚‰ãŒæ½°ã‚Œã‚‹éŸ³ã€‚</p>
                <div class="ending-card">
                    <div class="end-title">BAD END: å‚µå‹™ä¸å±¥è¡Œã«ã‚ˆã‚‹å¼·åˆ¶åŸ·è¡Œ</div>
                    <p>è²¬ä»»ã‹ã‚‰é€ƒã’ç¶šã‘ãŸç”·ã¯ã€ãã®å‘½ã§è² å‚µã‚’æ”¯æ‰•ã†ã“ã¨ã«ãªã£ãŸã€‚</p>
                </div>
            `,
            choices: [
                { text: "ã‚¿ã‚¤ãƒˆãƒ«ã«æˆ»ã‚‹", next: "back_to_title" }
            ]
        },

        // --- æ¯è¦ªã¨ã®å¥‘ç´„ï¼ˆãƒ«ãƒ¼ãƒˆå¾©å¸°ï¼‰ ---
        pact_mom: {
            icon: "ğŸ¤",
            bg: "bg_home_altar",
            cg: "cg_misaki_ghost_hollow", // â˜…CGï¼šå…±çŠ¯ã®ç¬‘é¡”
            text: `
                <p>ã€Œã‚„ã‚Šã¾ã—ã‚‡ã†ã€‚ãŠæ¯ã•ã‚“ã€<br>
                ç§ã¯æ¯è¦ªã®æ‰‹ã‚’å–ã‚Šã€é™ã‹ã«å‘Šã’ãŸã€‚<br>
                ã€Œåƒ•ã®æ‰‹ã¯ã‚‚ã†æ±šã‚Œã¦ã„ã¾ã™ã€‚ç¾å’²ã¨ä¸€ç·’ã«ã€åœ°ç„ã¾ã§è¡Œãã¾ã™ã‹ã‚‰ã€</p>
                <p>ç§ã®è¨€è‘‰ã‚’èã„ãŸç¬é–“ã€æ¯è¦ªã®è¡¨æƒ…ã‹ã‚‰é™ºã—ã•ãŒæ¶ˆãˆãŸã€‚<br>
                ä»£ã‚ã‚Šã«æµ®ã‹ã‚“ã ã®ã¯ã€æ­ªã§ã€æ·±ã„å…±æ„Ÿã®ç¬‘ã¿ã ã£ãŸã€‚</p>
                <p>ã€Œâ€¦â€¦ã„ã„å­ã­ã€‚ã‚ã®å­ãŒé¸ã‚“ã ã ã‘ã‚ã‚‹ã‚ã€</p>
                <p>éƒ¨å±‹ã®éš…ã«ã€ç¾å’²ã®éœŠãŒç«‹ã£ã¦ã„ã‚‹ã®ãŒè¦‹ãˆãŸã€‚<br>
                å½¼å¥³ã¯å¾®ç¬‘ã‚“ã§ã„ã‚‹ã€‚ã¨ã¦ã‚‚æ‚²ã—ãã€ã¨ã¦ã‚‚æ®‹é…·ãªç¬‘é¡”ã§ã€‚<br>
                ã“ã‚Œã§å¥‘ç´„ã¯æˆç«‹ã—ãŸã€‚<br>
                ç§ã¯ç¾å’²ã®ã‚¹ãƒãƒ›ã‚’æ‡ã«å…¥ã‚Œã€æˆ¦å ´ï¼ˆã‚ªãƒ•ã‚£ã‚¹ï¼‰ã¸ã¨æˆ»ã‚‹ã€‚</p>
                <p>ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã¯äºŒäººã€‚<br>
                å®Ÿè¡Œéƒ¨éšŠã®çŠ¬é£¼ã€‚ãã—ã¦ã€è«¸æ‚ªã®æ ¹æºã§ã‚ã‚‹æ¨©ç”°ã€‚</p>
            `,
            choices: [
                { text: "æœˆæ›œæ—¥ã€å¾©è®ã®å¹•ã‚’é–‹ã‘ã‚‹", next: "revenge_inukai_intro" }
            ]
        },

        // --- å¾©è®ï¼šçŠ¬é£¼ ---
        revenge_inukai_intro: {
            icon: "ğŸ¢",
            bg: "bg_office_night",
            music: "bgm_office", // â˜…Ambienceï¼šæ—¥å¸¸
            text: `
                <span class="name">æœˆæ›œæ—¥ çµŒç†éƒ¨ãƒ•ãƒ­ã‚¢</span>
                <p>ç§ã¯ä½•é£Ÿã‚ã¬é¡”ã§å‡ºç¤¾ã—ãŸã€‚<br>
                æ‡ã«ã¯ç¾å’²ã®ã‚¹ãƒãƒ›ã¨ã„ã†åã®èµ·çˆ†ã‚¹ã‚¤ãƒƒãƒã‚’æŠ±ãˆã¦ã„ã‚‹ã€‚</p>
                <p>è¦–ç·šã®å…ˆã«ã¯ã€<span class="highlight">çŠ¬é£¼å…ˆè¼©</span>ã€‚<br>
                ç¾å’²ã«ä»•äº‹ã‚’ä¸¸æŠ•ã’ã—ã€å½¼å¥³ã®SOSã‚’æ¡ã‚Šã¤ã¶ã—ã€æ‰‹æŸ„ã‚’æ¨ªå–ã‚Šã—ã¦ã„ãŸç”·ã€‚<br>
                å½¼ã¯ä»Šã‚‚<span class="highlight">æ¥­å‹™ç”¨å¤§å‹ã‚·ãƒ¥ãƒ¬ãƒƒãƒ€ãƒ¼</span>ã®å‰ã§ã€èª°ã‹ã¨é›»è©±ã§è«‡ç¬‘ã—ã¦ã„ã‚‹ã€‚</p>
                <p>ã€Œã‚ãƒ¼ã€ã‚ã®è‡ªæ®ºã—ãŸå­ï¼Ÿ ã»ã‚“ã¨è¿·æƒ‘ã ã£ãŸã‚ˆãªãƒ¼ã€‚ãƒ¡ãƒ³ã‚¿ãƒ«å¼±ã™ãï¼ˆç¬‘ï¼‰ã€</p>
                <p>ç§ã®ä¸­ã§ã€ç†æ€§ã®ç³¸ãŒç„¼ãåˆ‡ã‚Œã‚‹éŸ³ãŒã—ãŸã€‚<br>
                åŒæ™‚ã«ã€PCã‹ã‚‰Teamsã®é€šçŸ¥éŸ³ãŒé³´ã‚ŠéŸ¿ãã€‚<br>
                ç¾å’²ã‹ã‚‰ã®æ‰¿èªä¾é ¼ã ã€‚</p>
                <p class="ghost-voice">
                ã€ã­ãˆã€å‡¦ç†ã‚·ãƒ†è‰¯ã‚¤ï¼Ÿã€
                </p>
            `,
            choices: [
                { text: "ã€Œã‚„ã‚Œã€ã¨å¿µã˜ã‚‹", next: "revenge_inukai_exec" }
            ]
        },

        revenge_inukai_exec: {
            icon: "ğŸ©¸",
            bg: "bg_shredder_room", // â˜…èƒŒæ™¯ï¼šã‚·ãƒ¥ãƒ¬ãƒƒãƒ€ãƒ¼å®¤
            sound: "se_execution", // â˜…SEï¼šå‡¦åˆ‘éŸ³
            effect: { blood: true, karma: +30 }, // â˜…è¡€ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
            text: `
                <p>ã€Œã‚„ã£ã¡ã¾ãˆã€ç¾å’²ã€</p>
                <p>å·¨å¤§ãªã‚·ãƒ¥ãƒ¬ãƒƒãƒ€ãƒ¼ãŒã€é£¢ãˆãŸç£ã®ã‚ˆã†ã«å”¸ã‚Šã‚’ä¸Šã’ã‚‹ã€‚<br>
                çŠ¬é£¼ã®ãƒã‚¯ã‚¿ã‚¤ãŒã€ã¾ã‚‹ã§æ„æ€ã‚’æŒã£ãŸè›‡ã®ã‚ˆã†ã«ãµã‚ã‚Šã¨æµ®ãä¸ŠãŒã‚Šã€é‹­åˆ©ãªåˆƒãŒå›è»¢ã™ã‚‹æŠ•å…¥å£ã¸ã¨å¸ã„è¾¼ã¾ã‚ŒãŸã€‚</p>
                <p>ã€Œãˆï¼Ÿ ã†ã‚ã€ã¡ã‚‡ã£ã€ã¨ï¼ï¼Ÿã€</p>
                <p><span class="glitch">ã‚¬ã‚¬ã‚¬ã‚¬ã‚¬ãƒƒï¼ï¼</span></p>
                <p>ç¡¬è³ªãªæ©Ÿæ¢°éŸ³ã¨ã€è‚‰ãŒæ½°ã‚Œã‚‹æ¹¿ã£ãŸéŸ³ãŒæ··ã–ã‚Šåˆã†ã€‚<br>
                å¼·åŠ›ãªãƒ¢ãƒ¼ã‚¿ãƒ¼ã«å¼•ã‹ã‚Œã€å…ˆè¼©ã®é¡”é¢ãŒå¼·åˆ¶çš„ã«åˆƒã®éš™é–“ã¸ã¨å¼•ããšã‚Šè¾¼ã¾ã‚Œã¦ã„ãã€‚<br>
                ã€Œã‚ãŒã£ã€ã”ã€ã’ãƒƒâ€¦â€¦ï¼ã€<br>
                å……è¡€ã—ãŸç›®ãŒã€åŠ©ã‘ã‚’æ±‚ã‚ã¦ç§ã‚’è¦‹ã‚‹ã€‚</p>
                <p>ç§ã¯å‹•ã‹ãªã„ã€‚ãŸã å†·ã‚„ã‚„ã‹ã«è¦‹ä¸‹ã‚ã—ãŸã€‚<br>
                ã€Œâ€¦â€¦çŠ¬é£¼å…ˆè¼©ã€‚ãã‚Œã€<span class="highlight">æé‡‘ä¸ç®—å…¥</span>ã§ã™ã­ã€</p>
                <p>æ•°ç§’å¾Œã€ã‚ªãƒ•ã‚£ã‚¹ã¯çµ¶å«ã¨é®®è¡€ã«åŒ…ã¾ã‚ŒãŸã€‚<br>
                ã ãŒã€ã¾ã çµ‚ã‚ã‚‰ãªã„ã€‚ãƒ©ã‚¹ãƒœã‚¹ãŒæ®‹ã£ã¦ã„ã‚‹ã€‚</p>
            `,
            choices: [
                { text: "æ¬¡ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã¸", next: "revenge_gonda_intro" }
            ]
        },

        // --- å¾©è®ï¼šæ¨©ç”° ---
        revenge_gonda_intro: {
            icon: "ğŸ“‰",
            bg: "cg_shredder_blood", // â˜…èƒŒæ™¯ï¼šè¡€ã¾ã¿ã‚Œ
            music: "bgm_chase",    // â˜…BGMï¼šç·Šå¼µ
            sound: "se_shredder",  // â˜…SEï¼šæ®‹éŸ¿
            effect: { blood: true },
            text: `
                <p>çŠ¬é£¼ã®æ­»ã¯ã€Œä¸æ…®ã®äº‹æ•…ã€ã¨ã—ã¦å‡¦ç†ã•ã‚ŒãŸã€‚<br>
                ç¤¾å†…ã¯ãƒ‘ãƒ‹ãƒƒã‚¯ã ãŒã€æ¨©ç”°éƒ¨é•·ã¯ä¿èº«ã«èµ°ã£ã¦ã„ã‚‹ã€‚</p>
                <p>æ±ºç®—å ±å‘Šä¼šè­°ã€‚<br>
                å½¹å“¡ãŸã¡ãŒWebä¼šè­°ã§é›†ã¾ã‚‹ä¸­ã€æ¨©ç”°ãŒéœ‡ãˆã‚‹å£°ã§ãƒ—ãƒ¬ã‚¼ãƒ³ã‚’å§‹ã‚ã‚‹ã€‚<br>
                ã€Œãˆãƒ¼ã€å½“æœŸã®æ¥­ç¸¾ã§ã™ãŒâ€¦â€¦éƒ¨ä¸‹ã®ç®¡ç†ä¸è¶³ã‚‚ã‚ã‚Šã¾ã—ã¦â€¦â€¦ã€</p>
                <p>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ã‚¿ãƒ¼ãŒæ˜æ»…ã™ã‚‹ã€‚<br>
                ç¾å’²ãŒä»‹å…¥ã—ã¦ã„ã‚‹ã€‚<br>
                ç§ã®PCã«ã€ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã€‚</p>
                <p style="border:1px solid #f00; color:#f00; padding:15px; text-align:center;">
                ã€ç¨Ÿè­°æ›¸ã€‘<br>
                æ¡ˆä»¶ï¼šæ¨©ç”°éƒ¨é•·ã®å›ºå®šè³‡ç”£é™¤å´<br>
                ç†ç”±ï¼šè€ç”¨å¹´æ•°è¶…éãŠã‚ˆã³ä¿®å¾©ä¸èƒ½ãªæ¬ é™¥<br>
                æ‰¿èªã—ã¾ã™ã‹ï¼Ÿ
                </p>
            `,
            choices: [
                { text: "ã€æ‰¿èª (Approve)ã€‘ãƒœã‚¿ãƒ³ã‚’å©ãã¤ã‘ã‚‹", next: "revenge_gonda_exec" }
            ]
        },

        revenge_gonda_exec: {
            icon: "ğŸ’€",
            bg: "bg_meeting_room",
            sound: "se_stamp", // â˜…SEï¼šæ‰¿èªéŸ³
            music: "bgm_ending", // â˜…BGMï¼šçµ‚ç„‰
            effect: { karma: +50, blood: false },
            text: `
                <p>ç§ãŒEnterã‚­ãƒ¼ã‚’å©ã„ãŸç¬é–“ã€‚</p>
                <p>ä¼šè­°å®¤ã®ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ã‹ã‚‰ã€ã‚ã®æ—¥ç¾å’²ãŒéŒ²éŸ³ã—ãŸç½µå£°ãŒå¤§éŸ³é‡ã§æµã‚ŒãŸã€‚<br>
                ã€ãŠå‰ã®ä»£ã‚ã‚Šãªã‚“ã¦ã„ãã‚‰ã§ã‚‚ã„ã‚‹ã‚“ã ã‚ˆï¼ æ­»ã‚“ã§è©«ã³ã‚ï¼ã€<br>
                ã€é£›ã³é™ã‚Šã‚‹ãªã‚‰ä¼šç¤¾ä»¥å¤–ã§ã‚„ã‚Œï¼ è¿·æƒ‘ã ï¼ã€</p>
                <p>å½¹å“¡ãŸã¡ãŒã–ã‚ã‚ãã€‚<br>
                ã€Œãªã€ãªã‚“ã ã“ã‚Œã¯ï¼ï¼Ÿ æ¶ˆã›ï¼ èª°ã ï¼ã€<br>
                æ¨©ç”°ãŒéŒ¯ä¹±ã—ã¦æš´ã‚Œã¾ã‚ã‚‹ã€‚é¡”è‰²ã¯åœŸæ°—è‰²ã ã€‚</p>
                <p>ãƒ‰ãƒ³ãƒƒï¼<br>
                æ¨©ç”°ãŒèƒ¸ã‚’æŠ¼ã•ãˆã¦å€’ã‚ŒãŸã€‚<br>
                å¿ƒä¸å…¨ã€‚<br>
                ã‚ã¾ã‚Šã«ã‚‚ã‚ã£ã‘ãªã„ã€ã—ã‹ã—ç¤¾ä¼šçš„ãªæ­»ã‚’ã‚‚ä¼´ã†å®Œå…¨ãªå¹•åˆ‡ã‚Œã€‚</p>
                <p>é¨’ç„¶ã¨ã™ã‚‹ã‚ªãƒ•ã‚£ã‚¹ã®ä¸­ã§ã€ç§ã¯ä¸æ€è­°ãªå®‰å µæ„Ÿã«åŒ…ã¾ã‚Œã¦ã„ãŸã€‚<br>
                ã“ã‚Œã§çµ‚ã‚ã£ãŸã€‚ç¾å’²ã®ç„¡å¿µã¯æ™´ã‚‰ã›ãŸã€‚<br>
                åƒ•ã‚‚ã€ã“ã‚Œã‹ã‚‰ã¯é™ã‹ã«æš®ã‚‰ã›ã‚‹ã¯ãšã ã€‚</p>
                <p>â€¦â€¦ãã†æ€ã£ã¦ã„ãŸã€‚<br>
                ã‚ã®ã€Œå‘Šç™½ã€ãŒã‚ã‚‹ã¾ã§ã¯ã€‚</p>
            `,
            choices: [
                { text: "å¾©è®ã¯æœãŸã•ã‚ŒãŸã€‚ãã®ã¯ãšã ã£ãŸ", next: "to_climax" }
            ]
        }
    };

    // â–¼â–¼â–¼ ã‚¨ãƒ³ã‚¸ãƒ³éƒ¨ â–¼â–¼â–¼
    const dom = {
        text: document.getElementById("narrative-area"),
        choices: document.getElementById("choices-container"),
        blood: document.getElementById("blood-fx")
    };

    // ã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿ç®¡ç†
    const savedData = JSON.parse(localStorage.getItem("yojitsu_save")) || { route: "revenge", sanity: 100, karma: 0 };

    function render(sceneId) {
        // ç”»é¢ãƒˆãƒƒãƒ—ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
        window.scrollTo(0, 0);
        document.getElementById("game-wrapper").scrollTop = 0;

        if(sceneId === "back_to_title") {
            window.location.href = "index.html";
            return;
        }

        if(sceneId === "to_climax") {
            savedData.cleared_revenge = true;
            savedData.karma += 50; 
            savedData.items = ["è£å¸³ç°¿", "ç¾å’²ã®ã‚¹ãƒãƒ›"];
            localStorage.setItem("yojitsu_save", JSON.stringify(savedData));
            window.location.href = "climax.html";
            return;
        }

        const scene = scenes[sceneId];
        
        // --- 1. ç”»åƒãƒ»éŸ³å£°åˆ¶å¾¡ ---
        if(scene) {
            visuals.setBg(scene.bg);
            visuals.setCg(scene.cg);
            
            if(scene.effect) {
                if(scene.effect.blood) {
                     visuals.setFilter("blood");
                     dom.blood.classList.add("active");
                } else {
                     visuals.setFilter("normal");
                     dom.blood.classList.remove("active");
                }
                if(scene.effect.karma) savedData.karma += scene.effect.karma;
            } else {
                visuals.setFilter("normal");
                dom.blood.classList.remove("active");
            }
            
            // ãƒ˜ãƒƒãƒ€ãƒ¼ã«ã‚‚èƒŒæ™¯ç”»åƒã‚’è¨­å®š
            if(scene.bg) {
                document.getElementById("scene-header").style.backgroundImage = `url('images/${scene.bg}.jpg')`;
            }

            if(scene.music === "stop") audio.stopBgm();
            else if(scene.music) audio.playBgm(scene.music);

            if(scene.sound) audio.playSe(scene.sound);
        }

        // --- 2. ç”»é¢æç”» ---
        dom.text.innerHTML = scene.text;
        
        dom.text.animate([{opacity:0}, {opacity:1}], {duration: 1000, fill:"forwards"});

        dom.choices.innerHTML = "";
        scene.choices.forEach(c => {
            const btn = document.createElement("button");
            btn.innerText = c.text;
            if(c.class) btn.className = c.class;
            btn.onclick = () => render(c.next);
            dom.choices.appendChild(btn);
        });
    }

    render("start");

</script>
</body>
</html>