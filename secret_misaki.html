<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>System Log: Misaki</title>
<style>
    body { 
        background-color: #000; 
        color: #0f0; 
        font-family: "Consolas", "Monaco", monospace; 
        margin: 0;
        padding: 40px; 
        line-height: 1.8; 
        font-size: 0.9rem; 
        min-height: 100vh;
        box-sizing: border-box;
    }

    /* 背景演出 */
    #bg-layer {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background-image: url('images/bg_server_room.jpg');
        background-size: cover; background-position: center;
        opacity: 0.2;
        filter: hue-rotate(100deg) contrast(2) brightness(0.5); /* 緑色の電脳空間風 */
        z-index: -1;
    }

    .container { 
        max-width: 900px; 
        margin: 0 auto; 
        border: 1px solid #0f0; 
        padding: 20px; 
        box-shadow: 0 0 20px rgba(0, 255, 0, 0.2); 
        background: rgba(0, 20, 0, 0.8);
        position: relative;
    }

    h1 { border-bottom: 1px solid #0f0; padding-bottom: 10px; margin-top: 0; color: #fff; text-shadow: 0 0 5px #0f0; }
    
    .log-entry { 
        margin-bottom: 30px; 
        border-left: 3px solid #005500; 
        padding-left: 15px; 
        opacity: 0; 
        animation: fadeIn 1s forwards; 
    }
    .date { color: #555; font-size: 0.8rem; margin-bottom: 5px; }
    .highlight { color: #f0f; font-weight: bold; text-shadow: 0 0 5px #f0f; }
    .error { color: #f00; font-weight: bold; text-shadow: 0 0 5px #f00; }
    .system { color: #0ff; }
    
    button { 
        background: #000; color: #f00; border: 1px solid #f00; 
        padding: 20px; cursor: pointer; margin-top: 50px; width: 100%; 
        font-size: 1.2rem; transition: all 0.3s; font-family: inherit;
    }
    button:hover { 
        background: #f00; color: #000; font-weight: bold; 
        box-shadow: 0 0 20px #f00;
    }
    
    @keyframes fadeIn { to { opacity: 1; } }
</style>
</head>
<body>

<div id="bg-layer"></div>

<div class="container">
    <h1>SYSTEM LOG: [ROOT_ACCESS_GRANTED]</h1>
    <p class="system">> USER: MISAKI_GHOST<br>> TARGET: AKUTO_MANAGER<br>> STATUS: OBSERVING</p>
    <br>

    <div class="log-entry" style="animation-delay: 0.5s;">
        <div class="date">LOG_ID: -090 [3 Months Ago]</div>
        <p>今日、決算の数字を改ざんさせられた。<br>
        権田部長に「お前の将来のためだ」って言われた。<br>
        亜久斗くんに相談しようとしたけど、彼は忙しそうだった。<br>
        ……迷惑かけたくない。私ひとりで何とかしなきゃ。</p>
    </div>

    <div class="log-entry" style="animation-delay: 1.5s;">
        <div class="date">LOG_ID: -001 [The Day]</div>
        <p>もう無理。全部バレる。私のせいにされる。<br>
        電話した。亜久斗くん、お願い、出て。<br>
        ……出ない。<br>
        そっか。見捨てられたんだ。<br>
        じゃあ、私が消えるしかないね。</p>
    </div>

    <div class="log-entry" style="animation-delay: 2.5s;">
        <div class="date">LOG_ID: 000 [Awakening]</div>
        <p>寒い。暗い。痛い。<br>
        でも、不思議。<br>
        身体が無くなったら、会社のネットワークの中が見えるようになった。<br>
        亜久斗くんのPC画面も、全部見える。<br>
        <span class="highlight">ずっと見てるよ。</span></p>
    </div>

    <div class="log-entry" style="animation-delay: 3.5s;">
        <div class="date">LOG_ID: 101 [Route: LOGIC]</div>
        <p>「論理」ルートの彼は冷たかった。<br>
        私のことを「バグ」扱いして、削除しようとした。<br>
        悲しい。そんなに私が邪魔？<br>
        だから、ちょっと強引にエラーを吐き出して困らせてあげた。</p>
    </div>

    <div class="log-entry" style="animation-delay: 4.5s;">
        <div class="date">LOG_ID: 102 [Route: REVENGE]</div>
        <p>「殺意」ルートの彼は怖かった。<br>
        ママとグルになって、私をまた殺そうとした。<br>
        でも、あの怒った顔も素敵。<br>
        私に向けられる感情なら、憎しみでも愛でも何でもいいの。</p>
    </div>

    <div class="log-entry" style="animation-delay: 5.5s;">
        <div class="date">LOG_ID: 103 [Route: FEAR]</div>
        <p>「恐怖」ルートは最高に惨めだった。<br>
        私の奴隷になって、泣きながら同僚を殺した。<br>
        ゾクゾクした。<br>
        私のために手を汚してくれるなんて、究極の愛だよね？</p>
    </div>

    <div class="log-entry" style="animation-delay: 6.5s;">
        <div class="date">LOG_ID: 104 [Route: EMOTION]</div>
        <p>「愛執」ルート……。<br>
        あれだけは反則。あんなに優しくされたら、成仏しそうになっちゃう。<br>
        でも、ダメ。<br>
        思い出だけで満足して、私を忘れるなんて許さない。<br>
        <span class="highlight">こっちに来てよ。</span></p>
    </div>

    <div class="log-entry" style="animation-delay: 8.0s;">
        <div class="date">LOG_ID: 666 [To: PLAYER]</div>
        <p>ねえ、画面の前の<span class="error">あなた</span>。<br>
        全部のルートを見たんでしょ？<br>
        面白かった？<br>
        <br>
        亜久斗くんを操って、何度も私に会いに来てくれてありがとう。<br>
        もう帰さない。<br>
        このゲームは、私と亜久斗くん……そして<span class="highlight">あなた</span>を閉じ込めるための檻なんだから。</p>
    </div>

    <button onclick="unlockLoop()">【檻】の中に入る</button>
</div>

<audio id="bgm-player" loop></audio>
<audio id="se-player"></audio>

<script src="audio.js"></script>
<script>
    /* =========================================
       システム制御 (Audio)
       ========================================= */
    // AudioEngine ラッパー
    const audio = {
        playedBgm: false,
        
        playBgm: function(filename) {
            if(this.playedBgm) return; // 一度だけ再生
            if(filename === "bgm_rain") AudioEngine.playAmbience("rain");
            else if(filename === "bgm_abyss") AudioEngine.playAmbience("abyss");
            else console.log("Unknown BGM:", filename);
            this.playedBgm = true;
        },
        playSe: function(filename) {
            if(filename === "se_glitch") AudioEngine.playGlitch();
            else if(filename === "se_slam") AudioEngine.playSlam();
            else console.log("Unknown SE:", filename);
        }
    };

    // テキスト表示に合わせてノイズ音を鳴らす
    window.addEventListener('load', () => {
        AudioEngine.init();
        // animation-delayと同期 (ms)
        const timeline = [500, 1500, 2500, 3500, 4500, 5500, 6500, 8000];
        
        timeline.forEach(t => {
            setTimeout(() => {
                audio.playSe("se_glitch");
            }, t);
        });
    });

    // 画面クリックで雨音（BGM）を開始
    document.body.addEventListener('click', function() {
        audio.playBgm("bgm_rain");
    });

    function unlockLoop() {
        // 衝撃音
        audio.playSe("se_slam");

        // 真・完結編へのフラグを立てる
        const save = JSON.parse(localStorage.getItem("yojitsu_save")) || {};
        save.read_misaki = true;
        localStorage.setItem("yojitsu_save", JSON.stringify(save));
        
        // 少し遅延させて遷移
        setTimeout(() => {
            window.location.href = "index.html";
        }, 800);
    }
</script>
</body>
</html>