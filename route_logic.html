<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>åŸ‹ã¾ã‚‰ãªã„äºˆå®Ÿå·®ã®é—‡ - Chapter 1: Logic</title>
<style>
    /* â–¼â–¼â–¼ è«–ç†ã®è’¼ã¨ãƒ‡ã‚¸ã‚¿ãƒ«ã®ç‹‚æ°— â–¼â–¼â–¼ */
    :root {
        --bg-color: #00050a;
        --text-main: #c0d0e0;
        --accent-blue: #007acc;
        --accent-cyan: #00ffff;
        --accent-error: #ff3333;
    }

    body {
        background-color: var(--bg-color);
        color: var(--text-main);
        font-family: "Yu Mincho", "Hiragino Mincho ProN", serif;
        line-height: 2.4;
        letter-spacing: 0.05em;
        margin: 0;
        display: flex;
        justify-content: center;
        min-height: 100vh;
        overflow: hidden; /* èƒŒæ™¯ç”»åƒç”¨ */
    }

    /* === ãƒ¬ã‚¤ãƒ¤ãƒ¼æ§‹é€  === */
    #layer-group {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        z-index: -1; pointer-events: none;
    }
    #bg-layer {
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        background-size: cover; background-position: center;
        transition: opacity 1s ease; 
        opacity: 0.5;
        filter: hue-rotate(180deg) contrast(1.2) brightness(0.8); /* é’ç™½ãå†·ãŸã„æ„Ÿã˜ */
    }
    #cg-layer {
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        display: flex; justify-content: center; align-items: center;
    }
    #cg-image {
        max-height: 90%; max-width: 90%;
        opacity: 0; transition: opacity 1s ease;
        filter: drop-shadow(0 0 10px #00ffff); /* ã‚µã‚¤ãƒãƒ¼ãªå…‰å½© */
    }

    #game-wrapper {
        width: 100%;
        max-width: 840px;
        height: 95vh;
        background-color: rgba(2, 8, 16, 0.9);
        box-shadow: 0 0 50px rgba(0, 122, 204, 0.2);
        display: flex;
        flex-direction: column;
        border: 1px solid #003366;
        position: relative;
        overflow-y: auto;
    }

    /* ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ãƒ˜ãƒƒãƒ€ãƒ¼ */
    #scene-header {
        height: 200px;
        background-size: cover;
        background-position: center;
        display: flex; align-items: center; justify-content: center;
        position: relative; overflow: hidden;
        border-bottom: 1px solid #0a2a4a;
        flex-shrink: 0;
        transition: background-image 0.5s ease;
    }
    #scene-header::before {
        content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
        background: linear-gradient(180deg, rgba(0,10,20,0.7) 0%, rgba(0,0,0,0.85) 100%);
        z-index: 1;
    }
    /* æŠ½è±¡çš„ãªã‚·ãƒ³ãƒœãƒ«ï¼ˆãƒ‡ã‚¸ã‚¿ãƒ«é¢¨ï¼‰ */
    #scene-symbol {
        width: 50px; height: 50px;
        border: 1px solid rgba(0,255,255,0.25);
        transform: rotate(45deg);
        position: relative;
        opacity: 0.5;
        z-index: 2;
    }
    #scene-symbol::before {
        content: ''; position: absolute;
        top: 50%; left: 50%; transform: translate(-50%, -50%);
        width: 25px; height: 25px;
        border: 1px solid rgba(0,255,255,0.4);
    }
    #scene-symbol::after {
        content: ''; position: absolute;
        top: 50%; left: 50%; transform: translate(-50%, -50%);
        width: 6px; height: 6px;
        background: rgba(0,255,255,0.3);
    }

    /* ãƒ‡ã‚¸ã‚¿ãƒ«ãƒã‚¤ã‚ºæ¼”å‡º */
    .glitch-overlay {
        position: absolute; top:0; left:0; width:100%; height:100%;
        background: repeating-linear-gradient(
            0deg,
            rgba(0, 255, 255, 0.05),
            rgba(0, 255, 255, 0.05) 1px,
            transparent 1px,
            transparent 2px
        );
        pointer-events: none; opacity: 0.5;
    }
    .scanline {
        width: 100%; height: 5px; background: rgba(0, 255, 255, 0.3);
        position: absolute; top: 0; left: 0; animation: scan 3s linear infinite; opacity: 0.3;
    }
    @keyframes scan { 0% {top:0%} 100% {top:100%} }

    /* æœ¬æ–‡ã‚¨ãƒªã‚¢ */
    #narrative-area {
        padding: 40px 50px;
        flex-grow: 1;
        font-size: 1.1rem;
        text-align: justify;
    }
    p { margin-bottom: 2.5em; opacity: 0; animation: fadeIn 1s forwards; }
    @keyframes fadeIn { to { opacity: 1; } }

    .highlight { color: var(--accent-cyan); font-weight: bold; font-family: monospace; }
    .error { color: var(--accent-error); font-weight: bold; font-family: monospace; }
    .name { color: var(--accent-blue); font-weight: bold; font-family: sans-serif; font-size: 0.9em; display: block; margin-bottom: 1em; }
    
    /* ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é¢¨ */
    .sys-msg { 
        font-family: "Consolas", "Monaco", monospace;
        background: rgba(0, 20, 40, 0.8);
        border: 1px solid var(--accent-blue);
        padding: 15px; margin: 2em 0;
        color: var(--accent-cyan); font-size: 0.9rem;
        box-shadow: 0 0 10px rgba(0,255,255,0.1);
    }

    /* é¸æŠè‚¢ã‚¨ãƒªã‚¢ */
    #choices-container {
        padding: 40px 60px 80px;
        display: flex; flex-direction: column; gap: 20px;
        background: linear-gradient(to top, rgba(0,0,0,0.9) 0%, rgba(2,8,16,0.9) 100%);
        border-top: 1px solid #003366;
    }
    button {
        background: rgba(5,16,32,0.9); color: #8ab; border: 1px solid #004488;
        padding: 25px 30px; text-align: left; 
        font-family: "Yu Mincho", serif; font-size: 1.05rem;
        cursor: pointer; transition: all 0.3s; position: relative;
    }
    button:hover { background: #002244; color: #fff; border-color: #00ffff; padding-left: 40px; box-shadow: 0 0 15px rgba(0, 255, 255, 0.2); }
    button::before { content: "ğŸ’»"; position: absolute; left: 15px; opacity: 0; transition: opacity 0.3s; font-size: 0.8em; }
    button:hover::before { opacity: 1; }

</style>
</head>
<body>

<div id="layer-group">
    <div id="bg-layer"></div>
    <div id="cg-layer"><img id="cg-image" src="" alt=""></div>
</div>

<div id="game-wrapper">
    <div id="scene-header">
        <div id="scene-symbol"></div>
        <div class="glitch-overlay"></div>
        <div class="scanline"></div>
    </div>

    <div id="narrative-area"></div>
    <div id="choices-container"></div>
</div>

<script src="audio.js"></script>
<script>
    /* =========================================
       ã‚·ã‚¹ãƒ†ãƒ åˆ¶å¾¡ (Audio & Image)
       ========================================= */
    // AudioEngine ãƒ©ãƒƒãƒ‘ãƒ¼
    const audio = {
        currentBgm: "",
        
        playBgm: function(filename) {
            if(this.currentBgm === filename) return;
            this.currentBgm = filename;
            
            if(filename === "bgm_ending") AudioEngine.playEndingTheme();
            else if(filename === "bgm_flashback") AudioEngine.playFlashbackTheme();
            else if(filename === "bgm_confession") AudioEngine.playConfessionTheme();
            else if(filename === "bgm_rain") AudioEngine.playAmbience("rain");
            else if(filename === "bgm_mystery") AudioEngine.playMysteryTheme();
            else if(filename === "bgm_horror") AudioEngine.playHorrorTheme();
            else if(filename === "bgm_chase") AudioEngine.playChaseTheme();
            else if(filename === "bgm_office") AudioEngine.playAmbience("office");
            else if(filename === "bgm_abyss") AudioEngine.playAmbience("abyss");
            else if(filename === "bgm_tinnitus") AudioEngine.playAmbience("tinnitus");
            else console.log("Unknown BGM:", filename);
        },
        stopBgm: function() {
            AudioEngine.stopMusic();
            this.currentBgm = "";
        },
        playSe: function(filename) {
            if(filename === "se_ping") AudioEngine.playPing();
            else if(filename === "se_glitch") AudioEngine.playGlitch();
            else if(filename === "se_slam") AudioEngine.playSlam();
            else if(filename === "se_execution") AudioEngine.playExecution();
            else if(filename === "se_impact") AudioEngine.playImpact();
            else if(filename === "se_heartbeat" || filename === "se_heart") AudioEngine.playHeartbeat();
            else if(filename === "se_shredder") AudioEngine.playShredder();
            else if(filename === "se_stamp") AudioEngine.playStamp();
            else console.log("Unknown SE:", filename);
        }
    };

    const visuals = {
        bg: document.getElementById("bg-layer"),
        cg: document.getElementById("cg-image"),
        
        setBg: function(filename) {
            if(!filename) return;
            this.bg.style.backgroundImage = `url('images/${filename}.jpg')`;
        },
        setCg: function(filename) {
            if(!filename) {
                this.cg.style.opacity = 0;
            } else {
                this.cg.src = `images/${filename}.png`;
                this.cg.style.opacity = 1;
            }
        },
        setFilter: function(type) {
            if(type === "error") {
                this.bg.style.filter = "hue-rotate(300deg) contrast(1.5) saturate(2)"; // èµ¤ç´«ï¼ˆã‚¨ãƒ©ãƒ¼ï¼‰
            } else {
                this.bg.style.filter = "hue-rotate(180deg) contrast(1.2) brightness(0.8)"; // é€šå¸¸ï¼ˆé’ç™½ï¼‰
            }
        }
    };

    // â–¼â–¼â–¼ ã‚·ãƒŠãƒªã‚ªãƒ‡ãƒ¼ã‚¿ï¼ˆè«–ç†ç·¨ï¼šç”»åƒãƒ»éŸ³å£°çµ±åˆç‰ˆï¼‰ â–¼â–¼â–¼
    const scenes = {
        // ----------------------------------------------------------
        // å°å…¥
        // ----------------------------------------------------------
        start: {
            icon: "âŒ¨ï¸",
            bg: "bg_office_night",    // â˜…èƒŒæ™¯ï¼šã‚ªãƒ•ã‚£ã‚¹
            music: "bgm_office",      // â˜…BGMï¼šæ—¥å¸¸
            text: `
                <span class="name">æ·±å¤œ2:20 è²¡å‹™çµŒç†éƒ¨ãƒ•ãƒ­ã‚¢</span>
                <p>
                ã€Œâ€¦â€¦é¦¬é¹¿ãªã€
                </p>
                <p>
                ç§ã¯å†·ã‚„ã‚„ã‹ã«å‘Ÿãã€çœ‰é–“ã‚’æ‰ã‚“ã ã€‚<br>
                å¹½éœŠï¼Ÿ å‘ªã„ï¼Ÿ ãã‚“ãªéç§‘å­¦çš„ãªã‚‚ã®ãŒã€ã“ã®é«˜åº¦ã«ãƒ‡ã‚¸ã‚¿ãƒ«åŒ–ã•ã‚ŒãŸã‚ªãƒ•ã‚£ã‚¹ã«å­˜åœ¨ã™ã‚‹ã¯ãšãŒãªã„ã€‚<br>
                ã“ã‚Œã¯æ˜ã‚‰ã‹ã«<span class="highlight">äººç‚ºçš„ãªå·¥ä½œï¼ˆã‚¯ãƒ©ãƒƒã‚­ãƒ³ã‚°ï¼‰</span>ã ã€‚
                </p>
                <p>
                ã€Œã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®å‰Šé™¤æ¼ã‚Œã‹â€¦â€¦ã‚ã‚‹ã„ã¯ã€èª°ã‹ãŒç¾å’²ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç›—ã‚“ã§æ‚ªæˆ¯ã—ã¦ã„ã‚‹ã®ã‹ã€
                </p>
                <p>
                ã‚‚ã—å¾Œè€…ãªã‚‰ã€è¨±ã—ãŒãŸã„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é•åã ã€‚<br>
                æ­»è€…ã‚’å†’æ¶œã—ã€ç§ã®æ¥­å‹™ã‚’å¦¨å®³ã™ã‚‹çŠ¯äººã‚’çªãæ­¢ã‚ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚<br>
                ç§ã¯æ„Ÿæƒ…ã‚’æ’ã—ã€ç®¡ç†è€…æ¨©é™ã§ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚’é–‹ã„ãŸã€‚
                </p>
                <div class="sys-msg">
                > CONNECTING TO SERVER... [OK]<br>
                > TARGET: [MISAKI_FPA]<br>
                > STATUS: ACTIVE (UNAUTHORIZED)
                </div>
            `,
            choices: [
                { text: "ã€æ”»æ’ƒã€‘ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’å¼·åˆ¶å‰Šé™¤ï¼ˆKill Processï¼‰ã™ã‚‹", next: "branch_attack" },
                { text: "ã€é˜²å¾¡ã€‘ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’åˆ‡æ–­ã—ã¦éš”é›¢ã™ã‚‹", next: "branch_defend" }
            ]
        },

        // ----------------------------------------------------------
        // åˆ†å²Aï¼šæ”»æ’ƒçš„å¯¾æŠ—ï¼ˆå¼·åˆ¶å‰Šé™¤ï¼‰
        // ----------------------------------------------------------
        branch_attack: {
            icon: "âš”ï¸",
            bg: "bg_server_room", // â˜…èƒŒæ™¯ï¼šã‚µãƒ¼ãƒãƒ¼ãƒ«ãƒ¼ãƒ 
            effect: "error",      // â˜…èµ¤ãã‚¨ãƒ©ãƒ¼è¡¨ç¤º
            sound: "se_glitch",   // â˜…SEï¼šã‚¨ãƒ©ãƒ¼éŸ³
            music: "bgm_chase",   // â˜…BGMï¼šãƒã‚§ã‚¤ã‚¹ï¼ˆé›»è„³æˆ¦ï¼‰
            text: `
                <p>
                ã€Œæ’é™¤ã—ã¦ã‚„ã‚‹ã€
                </p>
                <p>
                ç§ã¯ã‚³ãƒãƒ³ãƒ‰ã‚’æ‰“ã¡è¾¼ã‚“ã ã€‚<br>
                ã€DELETE USER MISAKI_FPA /FORCEã€<br>
                ã‚¨ãƒ³ã‚¿ãƒ¼ã‚­ãƒ¼ã‚’å©ãã€‚ã“ã‚Œã§çµ‚ã‚ã‚Šã ã€‚
                </p>
                <p>
                ã—ã‹ã—ã€ç”»é¢ã«ã¯èµ¤ã„æ–‡å­—åˆ—ãŒå¥”æµã®ã‚ˆã†ã«æº¢ã‚Œå‡ºã—ãŸã€‚
                </p>
                <div class="sys-msg" style="border-color:red; color:red;">
                > ERROR: ACCESS DENIED<br>
                > ERROR: PERMISSION LEVEL INSUFFICIENT<br>
                > YOU CANNOT DELETE ME.
                </div>
                <p>
                ã€Œãªã£â€¦â€¦æ¨©é™ãŒãªã„ã ã¨ï¼Ÿã€
                </p>
                <p>
                PCãŒç•°å¸¸ãªç†±ã‚’ç™ºã—ã€å†·å´ãƒ•ã‚¡ãƒ³ãŒã‚¸ã‚§ãƒƒãƒˆæ©Ÿã®ã‚ˆã†ãªè½ŸéŸ³ã‚’ç«‹ã¦å§‹ã‚ãŸã€‚<br>
                ç”»é¢ã®å‘ã“ã†ã‹ã‚‰ã€ä½•ã‹ãŒã€Œé€†æµã€ã—ã¦ãã‚‹ã€‚<br>
                ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãŒå‹æ‰‹ã«æ‰“éµã•ã‚Œã€ç§ã®æ„æ€ã‚’ç„¡è¦–ã—ã¦æ–‡å­—ã‚’æ‰“ã¡è¾¼ã¿å§‹ã‚ãŸã€‚
                </p>
                <p>
                <span class="highlight">ã€ç§ãƒ²æ¶ˆã‚½ã‚¦ãƒˆã‚·ã‚¿ãƒï¼Ÿã€</span><br>
                <span class="highlight">ã€è¨±ã‚µãƒŠã‚¤ã€‚è¦‹ãƒ†ã€‚ã‚³ãƒ¬ã‚¬ç¾å®Ÿãƒ€ãƒ¨ã€‚ã€</span>
                </p>
            `,
            choices: [
                { text: "å‹æ‰‹ã«ãƒ•ã‚¡ã‚¤ãƒ«ãŒé–‹ã‹ã‚Œã‚‹", next: "common_shadow_ledger" }
            ]
        },

        // ----------------------------------------------------------
        // åˆ†å²Bï¼šé˜²å¾¡çš„å¯¾æŠ—ï¼ˆåˆ‡æ–­ï¼‰
        // ----------------------------------------------------------
        branch_defend: {
            icon: "ğŸ›¡ï¸",
            bg: "bg_shredder_room", // â˜…èƒŒæ™¯ï¼šå¤§é‡ã®ç´™ï¼ˆã‚·ãƒ¥ãƒ¬ãƒƒãƒ€ãƒ¼å®¤ä»£ç”¨ï¼‰
            sound: "se_shredder",   // â˜…SEï¼šå°åˆ·ãƒ»ç´™ã®éŸ³
            music: "bgm_chase",
            text: `
                <p>
                ã€Œã¾ãšã¯éš”é›¢ã ã€‚è¢«å®³ã‚’åºƒã’ã‚‹ã‚ã‘ã«ã¯ã„ã‹ãªã„ã€
                </p>
                <p>
                ç§ã¯å†·é™ã«LANã‚±ãƒ¼ãƒ–ãƒ«ã‚’å¼•ãæŠœãã€Wi-Fiã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã‚’ç„¡åŠ¹åŒ–ã—ãŸã€‚<br>
                ç‰©ç†å±¤ã§ã®é®æ–­ã€‚ã“ã‚Œã§å¤–éƒ¨ã‹ã‚‰ã®æ“ä½œã¯ä¸å¯èƒ½ãªã¯ãšã ã€‚
                </p>
                <p>
                ã—ã‹ã—ã€ç•°å¤‰ã¯PCã§ã¯ãªãã€èƒŒå¾Œã§èµ·ããŸã€‚
                </p>
                <p>
                <strong style="color:var(--accent-cyan);">ã‚¦ã‚£ã‚£ã‚£ã‚£ã‚£ãƒ³â€¦â€¦ã‚¬ã‚·ãƒ£ãƒ³ï¼</strong>
                </p>
                <p>
                è¤‡åˆæ©Ÿï¼ˆãƒ—ãƒªãƒ³ã‚¿ãƒ¼ï¼‰ãŒå‹æ‰‹ã«èµ·å‹•ã—ã€çŒ›çƒˆãªå‹¢ã„ã§å°åˆ·ã‚’å§‹ã‚ãŸã®ã ã€‚<br>
                åãå‡ºã•ã‚Œã‚‹å¤§é‡ã®A4ç”¨ç´™ã€‚<br>
                ãã“ã«ã¯ã€ã³ã£ã—ã‚Šã¨ãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿ã¨ã€ä¸æ°—å‘³ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå°å­—ã•ã‚Œã¦ã„ãŸã€‚
                </p>
                <p>
                <span class="error">ã€ç„¡è¦–ã‚¹ãƒ«ãƒŠã€</span><br>
                <span class="error">ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒã€ãƒ‰ã‚³ãƒ‹ãƒ‡ãƒ¢ã‚¢ãƒ«ã€</span>
                </p>
                <p>
                ã€Œé¦¬é¹¿ãªâ€¦â€¦é›»æºã™ã‚‰å…¥ã‚Œã¦ã„ãªã„ã®ã«ï¼ã€<br>
                æœ€å¾Œã«åãå‡ºã•ã‚ŒãŸä¸€æšã®ç´™ã€‚ãã‚Œã¯ã€è£å¸³ç°¿ã€ã¨ã„ã†ã‚¿ã‚¤ãƒˆãƒ«ã®Excelã‚·ãƒ¼ãƒˆã ã£ãŸã€‚
                </p>
            `,
            choices: [
                { text: "ç´™ã‚’æ‹¾ã„ä¸Šã’ã‚‹", next: "common_shadow_ledger" }
            ]
        },

        // ----------------------------------------------------------
        // åˆæµï¼šè£å¸³ç°¿ã®é–‹ç¤º
        // ----------------------------------------------------------
        common_shadow_ledger: {
            icon: "ğŸ“‚",
            bg: "bg_office_night",
            effect: "normal",     // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æˆ»ã™
            music: "bgm_mystery", // â˜…BGMï¼šè¬è§£ã
            text: `
                <p>
                ç”»é¢ä¸Šï¼ˆã‚ã‚‹ã„ã¯å°åˆ·ã•ã‚ŒãŸç´™ï¼‰ã«å±•é–‹ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã€‚<br>
                ãã‚Œã¯ã€è†¨å¤§ãªé‡ã®<span class="highlight">ä¸æ­£ä¼šè¨ˆè¨˜éŒ²</span>ã ã£ãŸã€‚
                </p>
                <p>
                æ¨©ç”°éƒ¨é•·ã«ã‚ˆã‚‹æ¶ç©ºå£²ä¸Šè¨ˆä¸Šã€åˆ©ç›Šã®ç²‰é£¾ã€‚<br>
                çŠ¬é£¼å…ˆè¼©ã«ã‚ˆã‚‹æ¥­è€…ã¸ã®ã‚­ãƒƒã‚¯ãƒãƒƒã‚¯è¦æ±‚ã¨ã€äº¤éš›è²»ã®ç§çš„æµç”¨ã€‚<br>
                ã™ã¹ã¦ã€æ—¥ä»˜ã¨é‡‘é¡ãŒè«–ç†çš„ã«æ•´åˆã—ã¦ã„ã‚‹ã€Œå®Œç’§ãªè¨¼æ‹ ã€ã ã€‚
                </p>
                <p>
                ã€Œã“ã‚ŒãŒâ€¦â€¦ç¾å’²ãŒéš ã—æŒã£ã¦ã„ãŸçˆ†å¼¾ã‹ã€
                </p>
                <p>
                <div class="sys-msg">
                > SYSTEM MESSAGE:<br>
                > "ã“ã‚Œã‚¬ã€ç§ãƒæœªå‡¦ç†æ®‹é«˜ï¼ˆæ¨ã¿ï¼‰ãƒ‡ã‚·ãƒ§ï¼Ÿ<br>
                > ç™ºç”Ÿæºï¼ˆSourceï¼‰ãƒ²ã€ç‰¹å®šã‚·ãƒ†ã€‚"
                </div>
                </p>
                <p>
                ç”»é¢ã«åœ°å›³ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã€‚ç¤ºã•ã‚ŒãŸIPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ç‰©ç†çš„ãªä½ç½®ã€‚<br>
                ãã‚Œã¯ã€ç¾å’²ã®å®Ÿå®¶ã ã£ãŸã€‚<br>
                ã€Œå®Ÿå®¶ã®ç«¯æœ«ãŒãƒ›ã‚¹ãƒˆï¼ˆè¦ªæ©Ÿï¼‰ã«ãªã£ã¦ã„ã‚‹ã®ã‹â€¦â€¦ã€
                </p>
            `,
            choices: [
                { text: "ã“ã®ã€Œãƒã‚°ã€ã®ç™ºç”Ÿæºã‚’ç‰©ç†çš„ã«å©ã", next: "logic_decision" }
            ]
        },

        logic_decision: {
            icon: "ğŸ§ ",
            bg: "bg_office_night",
            text: `
                <p>
                ç§ã¯æ±—ã°ã‚“ã æ‰‹ã§ãƒã‚¯ã‚¿ã‚¤ã‚’ç·©ã‚ãŸã€‚<br>
                è«–ç†çš„ã«è€ƒãˆã‚ã€‚<br>
                å¹½éœŠã«ãªã©ä¼šã„ã«ã„ãã®ã§ã¯ãªã„ã€‚<br>
                ã‚·ã‚¹ãƒ†ãƒ ãƒˆãƒ©ãƒ–ãƒ«ã®ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã«è¡Œãã ã‘ã ã€‚
                </p>
                <p>
                ã€Œå®Ÿå®¶ã«è¡Œã£ã¦ã€ãã®ãƒ‡ãƒã‚¤ã‚¹ã‚’å›åã—ã€ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³ã™ã‚Œã°çµ‚ã‚ã‚‹ã€
                </p>
                <p>
                ç§ã¯USBãƒ¡ãƒ¢ãƒªã«ã“ã®ä¸æ­£ãƒ‡ãƒ¼ã‚¿ã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã—ã€ç«‹ã¡ä¸ŠãŒã£ãŸã€‚<br>
                ã“ã‚Œã¯å¾©è®ã§ã¯ãªã„ã€‚<br>
                <span class="highlight">ä¸æ•´åˆï¼ˆã‚¨ãƒ©ãƒ¼ï¼‰ã®ä¿®æ­£</span>ã ã€‚
                </p>
            `,
            choices: [
                { text: "ç¿Œæ—¥ã€å®Ÿå®¶ã¸å‘ã‹ã†", next: "logic_home_visit" }
            ]
        },

        // ----------------------------------------------------------
        // å®Ÿå®¶è¨ªå•ï¼šå¯¾è©±ã®åˆ†å²
        // ----------------------------------------------------------
        logic_home_visit: {
            icon: "ğŸ ",
            bg: "bg_home_altar", // â˜…èƒŒæ™¯ï¼šå®Ÿå®¶
            music: "bgm_rain",   // â˜…BGMï¼šé›¨
            text: `
                <span class="name">ç¿Œæ—¥ æ—¥æ›œæ—¥ ç¾å’²ã®å®Ÿå®¶</span>
                <p>
                ç§ã¯ç¾å’²ã®å®Ÿå®¶ã‚’è¨ªã‚ŒãŸã€‚<br>
                ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ›ãƒ³ã‚’æŠ¼ã™ã¨ã€ã‚„ã¤ã‚Œæœã¦ãŸæ¯è¦ªãŒå‡ºã¦ããŸã€‚<br>
                ã€Œâ€¦â€¦ã‚ˆãæ¥ãŸã‚ã­ã€è£åˆ‡ã‚Šè€…ã€
                </p>
                <p>
                ä»é–“ã«é€šã•ã‚Œã‚‹ã¨ã€ãã“ã«ã¯ã²ã³å‰²ã‚ŒãŸã‚¹ãƒãƒ›ãŒç¥€ã‚‰ã‚Œã¦ã„ãŸã€‚<br>
                ã‚ã‚Œã ã€‚ã‚ã‚ŒãŒé€ä¿¡å…ƒã ã€‚<br>
                å›åã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ãŒã€æ¯è¦ªã¯æ•µæ„ã‚’å‰¥ãå‡ºã—ã«ã—ã¦ã„ã‚‹ã€‚ã©ã†ã™ã‚‹ï¼Ÿ
                </p>
            `,
            choices: [
                { text: "ã€æ¬ºçã€‘ã€Œè¨´è¨Ÿã«ãªã‚Šã¾ã™ã‚ˆã€ã¨å˜˜ã‚’ã¤ã„ã¦è„…ã™", next: "branch_lie" },
                { text: "ã€å¼·è¡Œã€‘å•ç­”ç„¡ç”¨ã§å¥ªã„å–ã‚‹", next: "branch_force" }
            ]
        },

        // ----------------------------------------------------------
        // åˆ†å²Cï¼šæ¬ºçï¼ˆå†·å¾¹ãªè«–ç†ï¼‰
        // ----------------------------------------------------------
        branch_lie: {
            icon: "âš–ï¸",
            bg: "bg_home_altar",
            cg: "cg_smartphone", // â˜…CGï¼šã‚¹ãƒãƒ›
            text: `
                <p>
                ç§ã¯è¡¨æƒ…ä¸€ã¤å¤‰ãˆãšã«å˜˜ã‚’ã¤ã„ãŸã€‚
                </p>
                <p>
                ã€ŒãŠæ¯æ§˜ã€‚æ®‹å¿µãªãŒã‚‰ã€ç¾å’²ã•ã‚“ã®ç«¯æœ«ã‹ã‚‰ç¤¾å†…ã‚µãƒ¼ãƒãƒ¼ã¸ã®ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹ãŒç¢ºèªã•ã‚Œã¾ã—ãŸã€‚<br>
                ã“ã®ã¾ã¾ã§ã¯ã€ã”éºæ—ã«å¯¾ã—ã¦<span class="error">æ•°åƒä¸‡å††ã®æå®³è³ å„Ÿè«‹æ±‚</span>ãŒè¡Œã‚ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€
                </p>
                <p>
                ã€Œãã€ãã‚“ãªâ€¦â€¦ã‚ã®å­ã¯æ­»ã‚“ã§ã‚‹ã®ã‚ˆï¼ï¼Ÿã€
                </p>
                <p>
                ã€Œãˆãˆã€‚ã§ã™ãŒã€ç®¡ç†è²¬ä»»ã¯å•ã‚ã‚Œã¾ã™ã€‚<br>
                ä»Šã™ãç«¯æœ«ã‚’ç§ãŒå›åã—ã€ãƒ­ã‚°ã‚’æ¶ˆå»ã™ã‚Œã°ã€ç©ä¾¿ã«æ¸ˆã¾ã›ã‚‰ã‚Œã¾ã™ã€‚<br>
                ã©ã†ã—ã¾ã™ã‹ï¼Ÿ ä¼šç¤¾ã¨æˆ¦ã„ã¾ã™ã‹ï¼Ÿã€
                </p>
                <p>
                æ¯è¦ªã¯é’ã–ã‚ã€éœ‡ãˆã‚‹æ‰‹ã§ã‚¹ãƒãƒ›ã‚’å·®ã—å‡ºã—ãŸã€‚<br>
                ã€ŒãŠã€ãŠé¡˜ã„ã—ã¾ã™â€¦â€¦ã‚ã®å­ã®åèª‰ã‚’å®ˆã£ã¦ãã ã•ã„â€¦â€¦ã€
                </p>
                <p>
                ãƒãƒ§ãƒ­ã„ã‚‚ã®ã ã€‚<br>
                ç§ã¯ã‚¹ãƒãƒ›ã‚’å—ã‘å–ã‚Šã€ä¸€ç¤¼ã—ã¦å®¶ã‚’å‡ºãŸã€‚
                </p>
            `,
            choices: [
                { text: "ã‚¹ãƒãƒ›å†…ã®è¨¼æ‹ ãƒ‡ãƒ¼ã‚¿ã‚’ç²¾æŸ»ã™ã‚‹", next: "monday_prep" }
            ]
        },

        // ----------------------------------------------------------
        // åˆ†å²Dï¼šå¼·è¡Œï¼ˆç‰©ç†çš„æ’é™¤ï¼‰
        // ----------------------------------------------------------
        branch_force: {
            icon: "ğŸ‘Š",
            bg: "bg_home_altar",
            cg: "cg_smartphone",
            sound: "se_slam",
            text: `
                <p>
                è­°è«–ãªã©ç„¡é§„ã ã€‚ç§ã¯ç«‹ã¡ä¸ŠãŒã‚Šã€ä»å£‡ã«æ‰‹ã‚’ä¼¸ã°ã—ãŸã€‚
                </p>
                <p>
                ã€Œãªã£ã€ä½•ã‚’ã™ã‚‹ã®ï¼ï¼Ÿã€
                </p>
                <p>
                ã€Œã“ã‚Œã¯ä¼šç¤¾ã®æ‰€æœ‰ç‰©ã§ã™ã€‚å›åã—ã¾ã™ã€<br>
                ç§ã¯æ¯è¦ªã®æ‰‹ã‚’å¼·å¼•ã«æŒ¯ã‚Šæ‰•ã„ã€ã‚¹ãƒãƒ›ã‚’æ´ã¿å–ã£ãŸã€‚
                </p>
                <p>
                ã€Œè¿”ã—ã¦ï¼ ãƒ‰ãƒ­ãƒœã‚¦ï¼ äººæ®ºã—ï¼ã€<br>
                æ¯è¦ªãŒç§ã®èƒŒä¸­ã«ã—ãŒã¿ã¤ãã€çˆªã‚’ç«‹ã¦ã‚‹ã€‚<br>
                ã€Œç—›ã£â€¦â€¦é›¢ã›ï¼ã€
                </p>
                <p>
                ç§ã¯å½¼å¥³ã‚’çªãé£›ã°ã—ãŸã€‚<br>
                ç•³ã®ä¸Šã«å€’ã‚Œè¾¼ã¿ã€æ³£ãå«ã¶æ¯è¦ªã€‚<br>
                å¾Œå‘³ã¯æœ€æ‚ªã ãŒã€ç›®çš„ã®ç‰©ã¯æ‰‹ã«å…¥ã‚ŒãŸã€‚<br>
                ç§ã¯é€ƒã’ã‚‹ã‚ˆã†ã«å®¶ã‚’å‡ºãŸã€‚
                </p>
            `,
            choices: [
                { text: "ä¹±ã‚ŒãŸæœã‚’ç›´ã—ã€ã‚¹ãƒãƒ›ã‚’ç¢ºèªã™ã‚‹", next: "monday_prep" }
            ]
        },

        // ----------------------------------------------------------
        // åˆæµï¼šæœˆæ›œæ—¥ã®å‘Šç™º
        // ----------------------------------------------------------
        monday_prep: {
            icon: "ğŸ“§",
            bg: "bg_office_night",
            music: "bgm_office",
            text: `
                <span class="name">æœˆæ›œæ—¥ çµŒç†éƒ¨ãƒ•ãƒ­ã‚¢</span>
                <p>
                ç§ã¯ã‚ªãƒ•ã‚£ã‚¹ã«æˆ»ã‚Šã€è‡ªèº«ã®PCã¨ç¾å’²ã®ã‚¹ãƒãƒ›ã‚’æ¥ç¶šã—ãŸã€‚<br>
                ä¸­èº«ã¯ã€Œè¨¼æ‹ ã€ã®å®åº«ã ã£ãŸã€‚<br>
                ç‰¹ã«ã€æ¨©ç”°éƒ¨é•·ãŒç¾å’²ã«ã€Œæ•°å­—ã‚’ã„ã˜ã‚Œã€ã¨å¼·è¦ã—ã¦ã„ã‚‹éŸ³å£°ãƒ‡ãƒ¼ã‚¿ã¯æ±ºå®šçš„ã ã£ãŸã€‚
                </p>
                <p>
                ã€Œã“ã‚Œã§å…¨ã¦ã®ãƒã‚°ï¼ˆä¸æ­£ï¼‰ã‚’ãƒ‘ãƒ¼ã‚¸ã§ãã‚‹ã€
                </p>
                <p>
                ç§ã¯è¿·ã‚ãšã€å…¨ç¤¾å“¡ãƒ»å…¨å½¹å“¡ãƒ»ã•ã‚‰ã«ã¯è¦ªä¼šç¤¾ã®ç›£æŸ»éƒ¨é–€ã‚’å«ã‚€ãƒ¡ãƒ¼ãƒªãƒ³ã‚°ãƒªã‚¹ãƒˆã‚’ä½œæˆã—ãŸã€‚<br>
                ä»¶åã¯ã€ã€é‡è¦ã€‘å†…éƒ¨çµ±åˆ¶ã«é–¢ã‚ã‚‹é‡å¤§ãªä¸æ­£ã®å‘Šç™ºãŠã‚ˆã³è¨¼æ‹ æå‡ºã€ã€‚<br>
                æœ¬æ–‡ã«ã¯ã€äº‹å®Ÿã ã‘ã‚’æ·¡ã€…ã¨è¨˜è¿°ã—ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ·»ä»˜ã—ãŸã€‚
                </p>
            `,
            choices: [
                { text: "é€ä¿¡ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™", next: "monday_purge" }
            ]
        },

        monday_purge: {
            icon: "ğŸ””",
            bg: "bg_office_night",
            sound: "se_ping", // â˜…SEï¼šå¤§é‡ã®é€šçŸ¥
            text: `
                <p>
                <div class="sys-msg">
                > SENDING... [COMPLETE]<br>
                > MAIL SENT TO 1,204 RECIPIENTS.
                </div>
                </p>
                <p>
                ã‚¨ãƒ³ã‚¿ãƒ¼ã‚­ãƒ¼ã‚’æŠ¼ã—ãŸç¬é–“ã ã£ãŸã€‚
                </p>
                <p>
                <strong style="color:var(--accent-cyan); font-size:1.2rem;">ãƒ”ãƒ³ï¼ ãƒ”ãƒ³ï¼ ãƒ”ãƒ­ãƒ³ï¼â™ª</strong>
                </p>
                <p>
                é™å¯‚ã«åŒ…ã¾ã‚Œã¦ã„ãŸãƒ•ãƒ­ã‚¢ã§ã€æ•°å°ã®PCãŒé€šçŸ¥éŸ³ã‚’ä¸Šã’ãŸã€‚<br>
                ãã‚Œã¯ã™ãã«åå°ã€äº”åå°ã¨åºƒãŒã‚Šã€æ•°ç§’å¾Œã«ã¯ãƒ•ãƒ­ã‚¢å…¨ä½“ãŒé›»å­éŸ³ã®ä¸å”å’ŒéŸ³ã«åŒ…ã¾ã‚ŒãŸã€‚<br>
                æ•°ç™¾äººã®ç¤¾å“¡ã®PCç”»é¢ã«ã€ç§ã®é€ã£ãŸå‘Šç™ºãƒ¡ãƒ¼ãƒ«ãŒä¸€æ–‰ã«ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã™ã‚‹ã€‚
                </p>
                <p>
                ã€Œãªã‚“ã ã“ã‚Œâ€¦â€¦ï¼Ÿã€<br>
                ã€ŒãŠã„ã€ã“ã‚Œæ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«é–‹ã„ã¦ã„ã„ã®ã‹ï¼Ÿã€<br>
                ã€Œã†ã‚ã£ã€æ¨©ç”°éƒ¨é•·ã®éŸ³å£°ãƒ‡ãƒ¼ã‚¿ã â€¦â€¦ï¼ ãƒã‚¸ã‹ã‚ˆã€
                </p>
                <p>
                ã–ã‚ã‚ããŒæ³¢ç´‹ã®ã‚ˆã†ã«åºƒãŒã‚Šã€ã‚„ãŒã¦æ€’å·ã¨æ··ä¹±ã«å¤‰ã‚ã£ã¦ã„ãã€‚<br>
                ç§ã¯ãã‚Œã‚’ã€è…•ã‚’çµ„ã‚“ã§å†·ã‚„ã‚„ã‹ã«çœºã‚ã¦ã„ãŸã€‚
                </p>
            `,
            choices: [
                { text: "ãƒ‘ãƒ‹ãƒƒã‚¯ã«é™¥ã‚‹äºŒäººã‚’è¦‹ã‚‹", next: "inukai_fall" }
            ]
        },

        // --- çŠ¬é£¼ã®æ’é™¤ ---
        inukai_fall: {
            icon: "âš ï¸",
            bg: "bg_office_night",
            sound: "se_shredder", // â˜…SEï¼šã‚·ãƒ¥ãƒ¬ãƒƒãƒ€ãƒ¼
            text: `
                <p>
                ä¸æ­£ã‚’æš´ã‹ã‚ŒãŸ<span class="highlight">çŠ¬é£¼å…ˆè¼©</span>ã®åå¿œã¯åŠ‡çš„ã ã£ãŸã€‚<br>
                å½¼ã¯çœŸã£é’ãªé¡”ã§ç«‹ã¡ä¸ŠãŒã‚Šã€å‘¨å›²ã®è¦–ç·šã«è€ãˆãã‚Œãšå¾Œãšã•ã‚Šã—ãŸã€‚
                </p>
                <p>
                ã€Œã¡ã€é•ã†ï¼ ä¿ºã˜ã‚ƒãªã„ï¼ ä¿ºã¯ã‚„ã‚‰ã•ã‚ŒãŸã ã‘ã ï¼ã€
                </p>
                <p>
                éŒ¯ä¹±ã—ãŸå½¼ã¯ã€è¶³ã‚’ã‚‚ã¤ã‚Œã•ã›ã€èƒŒå¾Œã§ç¨¼åƒã—ã¦ã„ãŸå¤§å‹ã‚·ãƒ¥ãƒ¬ãƒƒãƒ€ãƒ¼ã«æ¿€çªã—ãŸã€‚<br>
                ãã®æ‹å­ã«ã€å½¼ã®ãƒã‚¯ã‚¿ã‚¤ãŒæŠ•å…¥å£ã¸ã¨å¸ã„è¾¼ã¾ã‚Œã‚‹ã€‚
                </p>
                <p>
                ã€Œãã‚ƒã‚ã‚ã‚ã‚ã‚ï¼ï¼ã€
                </p>
                <p>
                æ©Ÿæ¢°çš„ãªé§†å‹•éŸ³ã¨å…±ã«ã€å½¼ã®æ‚²é³´ãŒé€”çµ¶ãˆãŸã€‚<br>
                ã‚ã‚ã¦ã¦åŒåƒšãŸã¡ãŒé§†ã‘å¯„ã‚Šã€ç·Šæ€¥åœæ­¢ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã€‚<br>
                ãã‚Œã¯å˜ãªã‚‹ä¸æ³¨æ„ã«ã‚ˆã‚‹åŠ´åƒç½å®³ã ã€‚<br>
                è«–ç†çš„ã«ã¯ãã†èª¬æ˜ãŒã¤ãã€‚â€¦â€¦ã‚ã¾ã‚Šã«ã‚¿ã‚¤ãƒŸãƒ³ã‚°ãŒè‰¯ã™ãã‚‹ã“ã¨ã‚’é™¤ã‘ã°ã€‚
                </p>
            `,
            choices: [
                { text: "æ¬¡ã¯éƒ¨é•·ã ", next: "gonda_collapse" }
            ]
        },

        // --- æ¨©ç”°ã®æ’é™¤ ---
        gonda_collapse: {
            icon: "ğŸ’€",
            bg: "bg_office_night",
            sound: "se_heart", // â˜…SEï¼šå¿ƒåœæ­¢
            music: "bgm_ending",
            text: `
                <p>
                ãã—ã¦<span class="highlight">æ¨©ç”°éƒ¨é•·</span>ã€‚<br>
                å½¼ã¯ç¤¾é•·å®¤ã«å‘¼ã³å‡ºã•ã‚Œã€å³ã—ã„è¿½åŠã‚’å—ã‘ã¦ã„ãŸã€‚<br>
                ãƒ¢ãƒ‹ã‚¿ãƒ¼è¶Šã—ã«è¦‹ãˆã‚‹ãã®é¡”è‰²ã¯ã€åœŸæ°—è‰²ã‚’é€šã‚Šè¶Šã—ã¦ç°è‰²ã ã£ãŸã€‚
                </p>
                <p>
                ã€Œãã€ã†ã…â€¦â€¦ãƒƒï¼ã€
                </p>
                <p>
                çªç„¶ã€å½¼ã¯èƒ¸ã‚’æ»ãã‚€ã—ã‚Šã€ãã®å ´ã«å´©ã‚Œè½ã¡ãŸã€‚<br>
                æ€¥æ€§å¿ƒä¸å…¨ã€‚<br>
                é•·å¹´ã®ä¸æ­£éš è”½ã«ã‚ˆã‚‹ã‚¹ãƒˆãƒ¬ã‚¹ã¨ã€ç™ºè¦šã®ã‚·ãƒ§ãƒƒã‚¯ãŒå¼•ãé‡‘ã‚’å¼•ã„ãŸã®ã ã‚ã†ã€‚<br>
                å½¼ã‚‚ã¾ãŸã€ãã®ã¾ã¾å¸°ã‚‰ã¬äººã¨ãªã£ãŸã€‚
                </p>
                <p>
                ã€Œâ€¦â€¦ãƒã‚°ã¯æ’é™¤ã•ã‚ŒãŸã€
                </p>
                <p>
                ç§ã¯å†·ã‚„ã‚„ã‹ã«ãã†çµè«–ã¥ã‘ãŸã€‚<br>
                ã“ã‚Œã§ã‚ªãƒ•ã‚£ã‚¹ã®ç§©åºã¯ä¿ãŸã‚ŒãŸã€‚<br>
                ã—ã‹ã—ã€ç§ã®PCã®ç”»é¢ã«ã¯ã¾ã ã€æ¶ˆãˆãªã„æ–‡å­—ãŒç‚¹æ»…ã—ã¦ã„ãŸã€‚
                </p>
                <div class="sys-msg">
                > SYSTEM STATUS: UNSTABLE<br>
                > UNKNOWN USER IS STILL CONNECTED.
                </div>
            `,
            choices: [
                { text: "ãã‚Œã§ã‚‚ã€æ—¥å¸¸ã¯ç¶šãï¼ˆ5æœˆã¸ï¼‰", next: "to_climax" }
            ]
        }
    };

    // â–¼â–¼â–¼ ã‚¨ãƒ³ã‚¸ãƒ³éƒ¨ â–¼â–¼â–¼
    const dom = {
        text: document.getElementById("narrative-area"),
        choices: document.getElementById("choices-container")
    };

    // ã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿ç®¡ç†
    const savedData = JSON.parse(localStorage.getItem("yojitsu_save")) || { route: "logic", sanity: 100, karma: 0 };

    function render(sceneId) {
        window.scrollTo(0, 0);
        document.getElementById("game-wrapper").scrollTop = 0;

        if(sceneId === "to_climax") {
            savedData.route = "logic";
            savedData.cleared_logic = true;
            savedData.items = ["ä¸æ­£ãƒ­ã‚°ãƒ‡ãƒ¼ã‚¿", "ç¾å’²ã®ã‚¹ãƒãƒ›(è¨¼æ‹ å“)"];
            localStorage.setItem("yojitsu_save", JSON.stringify(savedData));
            window.location.href = "climax.html";
            return;
        }

        const scene = scenes[sceneId];
        
        // --- 1. ç”»åƒãƒ»éŸ³å£°åˆ¶å¾¡ ---
        if(scene) {
            visuals.setBg(scene.bg);
            visuals.setCg(scene.cg);
            
            // ãƒ˜ãƒƒãƒ€ãƒ¼ã«ã‚‚èƒŒæ™¯ç”»åƒã‚’è¨­å®š
            if(scene.bg) {
                document.getElementById("scene-header").style.backgroundImage = `url('images/${scene.bg}.jpg')`;
            }
            
            if(scene.effect === "error") visuals.setFilter("error");
            else visuals.setFilter("normal");

            if(scene.music === "stop") audio.stopBgm();
            else if(scene.music) audio.playBgm(scene.music);

            if(scene.sound) audio.playSe(scene.sound);
        }

        // --- 2. ç”»é¢æç”» ---
        dom.text.innerHTML = scene.text;
        
        dom.text.animate([{opacity:0}, {opacity:1}], {duration: 1000, fill:"forwards"});

        dom.choices.innerHTML = "";
        scene.choices.forEach(c => {
            const btn = document.createElement("button");
            btn.innerText = c.text;
            btn.onclick = () => render(c.next);
            dom.choices.appendChild(btn);
        });
    }

    render("start");

</script>
</body>
</html>